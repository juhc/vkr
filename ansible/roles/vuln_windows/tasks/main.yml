- name: Validate vuln_enabled IDs
  ansible.builtin.assert:
    that:
      - (vuln_enabled | default([])) is iterable
      - (vuln_enabled | difference(vuln_windows_known)) | length == 0
    fail_msg: >-
      Unknown Windows vulnerability IDs: {{
        (vuln_enabled | difference(vuln_windows_known)) | join(', ')
      }}.
      Known: {{ vuln_windows_known | join(', ') }}

- name: Apply enabled Windows vulnerabilities
  ansible.builtin.include_tasks: "vulns/{{ item }}.yml"
  loop: "{{ vuln_enabled }}"
  loop_control:
    label: "{{ item }}"

