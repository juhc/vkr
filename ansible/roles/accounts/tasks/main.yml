- name: Validate accounts_users structure
  ansible.builtin.assert:
    that:
      - accounts_users is iterable
    fail_msg: "accounts_users must be a list"

- name: Apply accounts on Linux
  ansible.builtin.import_tasks: linux.yml
  when: ansible_os_family != "Windows"

- name: Apply accounts on Windows
  ansible.builtin.import_tasks: windows.yml
  when: ansible_os_family == "Windows"

