---
- name: Validate vuln_enabled IDs
  ansible.builtin.assert:
    that:
      - (vuln_enabled | default([])) is iterable
      - (vuln_enabled | difference(vkr_vuln_ad_known)) | length == 0
    fail_msg: >-
      Unknown AD vulnerability IDs: {{
        (vuln_enabled | difference(vkr_vuln_ad_known)) | join(', ')
      }}.
      Known: {{ vkr_vuln_ad_known | join(', ') }}

- name: Apply enabled AD vulnerabilities
  ansible.builtin.include_tasks: "vulns/{{ item }}.yml"
  loop: "{{ vuln_enabled }}"
  loop_control:
    label: "{{ item }}"

