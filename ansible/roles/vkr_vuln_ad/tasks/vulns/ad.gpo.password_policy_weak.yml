---
- name: Make domain password policy weak (best-effort)
  ansible.windows.win_shell: |
    try {
      Import-Module ActiveDirectory -ErrorAction Stop
      $tsZero = [TimeSpan]::Zero
      Set-ADDefaultDomainPasswordPolicy `
        -Identity (Get-ADDomain).DistinguishedName `
        -MinPasswordLength 0 `
        -ComplexityEnabled $false `
        -PasswordHistoryCount 0 `
        -MaxPasswordAge $tsZero `
        -MinPasswordAge $tsZero | Out-Null
      "OK"
    } catch {
      "SKIP/ERR"
    }
  changed_when: false
  failed_when: false

