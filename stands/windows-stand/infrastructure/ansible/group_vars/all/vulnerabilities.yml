---
# Конфигурация уязвимостей для Windows стенда

# Логика выбора:
# - вы редактируете списки ID в `vuln_profiles.*`
# - playbook передаёт нужный список в роль `vuln_windows` как `vuln_enabled`

vuln_profiles:
  windows_workstation:
    - windows.auth.no_password_policy.yml

  windows_server:
    - windows.auth.weak_admin_password
    - windows.auth.no_password_policy
    - windows.auth.guest_enabled
    - windows.priv.testadmin_in_admins
    - windows.network.smb1_enabled
    - windows.network.ntlmv1_enabled
    - windows.firewall.disabled
    - windows.updates.disabled

  domain_controller:
    # OS-level уязвимости (AD-специфичные можно добавить отдельной ролью позже)
    - windows.auth.no_password_policy
    - windows.network.ntlmv1_enabled
    - windows.audit.disabled

  # AD/DC-специфичные уязвимости (применяются ролью vuln_ad)
  domain_controller_ad:
    - ad.priv.user_in_domain_admins
    - ad.auth.asrep_roastable_user
    - ad.network.ldap_signing_disabled
    - ad.gpo.password_policy_weak
    - ad.gpo.account_lockout_disabled
    - ad.gpo.llmnr_enabled
    - ad.gpo.smb_signing_disabled
    - ad.gpo.ntlmv1_allowed
    - ad.gpo.firewall_disabled
    - ad.gpo.defender_disabled
    - ad.gpo.updates_disabled
    - ad.gpo.powershell_logging_disabled
    - ad.gpo.audit_disabled
    - ad.gpo.eventlog_retention_low
    - ad.gpo.rdp_open_to_all
    - ad.gpo.winrm_insecure
    - ad.gpo.no_lock_on_idle

vuln_verify:
  windows_workstation:
    enabled: []
    disabled: []
  windows_server:
    enabled: []
    disabled: []
  domain_controller:
    enabled: []
    disabled: []
  domain_controller_ad:
    enabled: []
    disabled: []