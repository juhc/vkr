# Структура веток репозитория

## Обзор

Проект использует веточную модель, где каждый учебный сценарий инфраструктуры находится в отдельной ветке Git. Это позволяет:
- Изолировать разработку разных сценариев
- Упростить управление версиями
- Обеспечить независимое развертывание сценариев
- Упростить навигацию по коду

## Ветки

### `main` (основная ветка)

**Содержимое:**
- Все общие компоненты проекта:
  - Terraform модули (`terraform/modules/`)
  - Ansible роли (`ansible/roles/`)
  - Документация (`docs/`)
  - Общие скрипты и конфигурации
- **Все сценарии** (для справки и разработки)

**Назначение:**
- Основная ветка для разработки общих компонентов
- Содержит полную копию всех сценариев
- Используется для синхронизации изменений между сценариями

### `scenario-isp-company`

**Содержимое:**
- Сценарий инфраструктуры ISP-компании (`scenarios/scenario-isp-company/`)
- Все общие компоненты (Terraform модули, Ansible роли, документация)

**Описание сценария:**
- Моделирует инфраструктуру интернет-провайдера
- Включает: RADIUS, DNS, биллинг, веб-серверы, почтовые серверы
- Сетевые сегменты: клиентская, инфраструктурная, сервисная, управляющая сети

**Использование:**
```bash
git checkout scenario-isp-company
cd scenarios/scenario-isp-company
# Следуйте инструкциям в README.md
```

### `scenario-office-organization`

**Содержимое:**
- Сценарий инфраструктуры офисной организации (`scenarios/scenario-office-organization/`)
- Все общие компоненты (Terraform модули, Ansible роли, документация)
- Terraform и Ansible конфигурации для развертывания

**Описание сценария:**
- Моделирует инфраструктуру небольшой IT-компании
- Включает: DMZ, внутренняя сеть, сеть разработки, управляющая сеть
- Веб-серверы, файловые серверы, базы данных, системы мониторинга

**Использование:**
```bash
git checkout scenario-office-organization
cd scenarios/scenario-office-organization
# Следуйте инструкциям в README.md или QUICKSTART.md
```

## Рабочий процесс

### Разработка нового сценария

1. **Создание ветки из main:**
   ```bash
   git checkout main
   git pull origin main
   git checkout -b scenario-new-scenario
   ```

2. **Создание структуры сценария:**
   ```bash
   mkdir -p scenarios/scenario-new-scenario
   # Создайте необходимые файлы
   ```

3. **Коммит изменений:**
   ```bash
   git add scenarios/scenario-new-scenario
   git commit -m "Добавлен новый сценарий"
   ```

4. **Удаление других сценариев из ветки (опционально):**
   ```bash
   # Если хотите изолировать только свой сценарий
   git rm -r scenarios/scenario-other-scenario
   git commit -m "Изоляция сценария в ветке"
   ```

### Обновление общих компонентов

1. **Обновление в main:**
   ```bash
   git checkout main
   # Внесите изменения в общие компоненты
   git add terraform/modules/ ansible/roles/ docs/
   git commit -m "Обновление общих компонентов"
   ```

2. **Синхронизация с ветками сценариев:**
   ```bash
   git checkout scenario-isp-company
   git merge main
   # Разрешите конфликты, если они возникнут
   git commit -m "Синхронизация с main"
   ```

### Развертывание сценария

1. **Переключение на ветку сценария:**
   ```bash
   git checkout scenario-isp-company
   ```

2. **Развертывание:**
   ```bash
   cd scenarios/scenario-isp-company
   # Следуйте инструкциям в DEPLOYMENT.md или QUICKSTART.md
   ```

## Структура файлов в ветках

### Общие компоненты (во всех ветках)

```
├── terraform/
│   └── modules/          # Переиспользуемые Terraform модули
├── ansible/
│   └── roles/            # Переиспользуемые Ansible роли
├── docs/                 # Общая документация
├── README.md             # Основной README проекта
└── BRANCHES.md           # Этот файл
```

### Специфичные для сценария (только в соответствующей ветке)

```
scenarios/
└── scenario-<name>/
    ├── README.md              # Описание сценария
    ├── QUICKSTART.md          # Быстрый старт
    ├── DEPLOYMENT.md          # Инструкции по развертыванию
    ├── network-topology.md    # Сетевая топология
    ├── machine-scenarios.md  # Описание машин
    ├── objectives.md          # Цели обучения
    ├── infrastructure/        # Terraform/Ansible конфигурации (если есть)
    └── scripts/              # Скрипты развертывания (если есть)
```

## Рекомендации

1. **Всегда работайте в ветке сценария** при разработке конкретного сценария
2. **Синхронизируйте изменения** из main регулярно
3. **Не коммитьте чувствительные данные** (пароли, ключи) - используйте Ansible Vault
4. **Документируйте изменения** в сценариях в соответствующих README
5. **Тестируйте развертывание** перед коммитом изменений

## Слияние изменений

При необходимости слияния изменений между ветками:

```bash
# Из сценария в main (для общих улучшений)
git checkout main
git merge scenario-isp-company --no-ff

# Из main в сценарий (для обновления общих компонентов)
git checkout scenario-isp-company
git merge main
```

## Публикация веток

Для публикации веток в удаленный репозиторий:

```bash
git push origin scenario-isp-company
git push origin scenario-office-organization
```

