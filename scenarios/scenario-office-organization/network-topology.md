# Детальная сетевая топология организации

## Схема сети

```
                            Internet
                                |
                        [ISP Router] (1.2.3.4)
                                |
                        [Edge Firewall] (192.168.1.1)
                                |
                        [Core Router] (192.168.1.10)
                                |
        +-----------------------+-----------------------+-----------------------+
        |                       |                       |                       |
    [DMZ VLAN]            [Internal VLAN]        [Dev VLAN]           [Mgmt VLAN]
    (192.168.10.0/24)     (192.168.20.0/24)     (192.168.30.0/24)    (192.168.40.0/24)
        |                       |                       |                       |
        +---+---+---+           +---+---+---+           +---+---+              +---+
            |   |   |               |   |   |               |   |                  |
          Web Mail DNS          File DC  DB Backup      Dev Test CI/CD        Jump
            |   |   |               |   |   |               |   |                  |
        +---+---+---+---+       +---+---+---+---+       +---+---+---+          +---+
        |   |   |   |   |       |   |   |   |   |       |   |   |   |          |   |
       WS  WS  WS  WS  WS      WS  WS  WS  WS  WS      WS  WS  WS  WS          WS
    (100-104)              (100-129)                  (100-103)              (100)
```

## Детальное описание сетевых сегментов

### DMZ (Demilitarized Zone) - 192.168.10.0/24

#### Шлюз: 192.168.10.1
#### Маска подсети: 255.255.255.0

| IP адрес | Имя хоста | Роль | ОС | Сервисы | Открытые порты | Уязвимости |
|----------|-----------|------|----|---------|----------------|------------|
| 192.168.10.10 | web-server | Веб-сервер | Ubuntu 20.04 | Apache 2.4.29, PHP 7.4, MySQL клиент | 80, 443, 8080 | Устаревшая версия Apache, Log4j 2.14.1 |
| 192.168.10.20 | mail-server | Почтовый сервер | Ubuntu 20.04 | Postfix, Dovecot | 25, 587, 993, 995 | Небезопасная конфигурация SMTP |
| 192.168.10.30 | dns-server | DNS сервер | Ubuntu 20.04 | BIND9 | 53 | Открытый рекурсивный DNS |

**Правила брандмауэра DMZ**:
- Разрешен входящий трафик: 80, 443, 25, 587, 993, 995, 53
- Разрешен исходящий трафик: Весь (для обновлений)
- Разрешен доступ к внутренней сети: Только к базе данных (порт 3306)

### Внутренняя сеть (Internal Network) - 192.168.20.0/24

#### Шлюз: 192.168.20.1
#### Маска подсети: 255.255.255.0
#### DHCP диапазон: 192.168.20.100 - 192.168.20.200

#### Серверы

| IP адрес | Имя хоста | Роль | ОС | Сервисы | Открытые порты | Уязвимости |
|----------|-----------|------|----|---------|----------------|------------|
| 192.168.20.10 | file-server | Файловый сервер | Ubuntu Server 20.04 | Samba 4.11, NFS | 139, 445, 2049 | Открытые шары с правами записи |
| 192.168.20.20 | dc-server | Domain Controller | Windows Server 2019 | Active Directory, DNS, DHCP | 53, 88, 135, 389, 445, 636 | SMBv1 включен, слабые пароли админов |
| 192.168.20.30 | db-server | База данных | Ubuntu Server 20.04 | MySQL 5.7 | 3306 | Удаленный доступ без шифрования, пароль root: root123 |
| 192.168.20.40 | backup-server | Сервер резервного копирования | Ubuntu Server 20.04 | Rsync, BackupPC | 22, 873 | SSH доступ по паролю, нешифрованные бэкапы |
| 192.168.20.50 | monitoring-server | Мониторинг | Ubuntu Server 20.04 | Prometheus, Grafana, Nagios | 9090, 3000, 5666 | Открытый веб-интерфейс без аутентификации |

#### Рабочие станции (192.168.20.100 - 192.168.20.129)

| Диапазон IP | Количество | ОС | Роль | Уязвимости |
|-------------|------------|----|----|------------|
| 192.168.20.100-110 | 11 | Windows 10/11 | Офисные рабочие станции | Необновленное ПО, отключенный Windows Defender |
| 192.168.20.111-120 | 10 | Ubuntu Desktop 20.04 | Разработчики | Открытые SSH порты, слабые пароли |
| 192.168.20.121-129 | 9 | Windows 10/11 | Офисные рабочие станции | Необновленное ПО, открытые порты RDP |

**Правила брандмауэра внутренней сети**:
- Разрешен входящий трафик: Только с DMZ (к базе данных)
- Разрешен исходящий трафик: Весь (для работы пользователей)
- Разрешен доступ к сети разработки: Только для разработчиков

### Сеть разработки (Development Network) - 192.168.30.0/24

#### Шлюз: 192.168.30.1
#### Маска подсети: 255.255.255.0

| IP адрес | Имя хоста | Роль | ОС | Сервисы | Открытые порты | Уязвимости |
|----------|-----------|------|----|---------|----------------|------------|
| 192.168.30.10 | dev-server | Сервер разработки | Ubuntu Server 20.04 | GitLab, Docker, Node.js | 80, 443, 22, 2375 | Уязвимые версии Docker, открытые Git репозитории |
| 192.168.30.20 | test-server | Сервер тестирования | Ubuntu Server 20.04 | Тестовые приложения, PostgreSQL | 80, 5432 | Тестовые данные в открытом виде |
| 192.168.30.30 | ci-cd-server | CI/CD сервер | Ubuntu Server 20.04 | Jenkins, GitLab CI | 8080, 22 | Открытый интерфейс Jenkins, credentials в открытом виде |

#### Рабочие станции разработчиков (192.168.30.100 - 192.168.30.103)

| IP адрес | Имя хоста | ОС | Роль | Уязвимости |
|----------|-----------|----|----|------------|
| 192.168.30.100 | dev-workstation-1 | Ubuntu Desktop 20.04 | Рабочая станция разработчика | Открытый SSH, слабые пароли |
| 192.168.30.101 | dev-workstation-2 | Ubuntu Desktop 20.04 | Рабочая станция разработчика | Открытый SSH, слабые пароли |
| 192.168.30.102 | dev-workstation-3 | Ubuntu Desktop 20.04 | Рабочая станция разработчика | Открытый SSH, слабые пароли |
| 192.168.30.103 | dev-workstation-4 | macOS | Рабочая станция разработчика | Необновленное ПО |

**Правила брандмауэра сети разработки**:
- Разрешен входящий трафик: Только из внутренней сети
- Разрешен исходящий трафик: Весь (для загрузки зависимостей)
- Доступ к production: Запрещен

### Управляющая сеть (Management Network) - 192.168.40.0/24

#### Шлюз: 192.168.40.1
#### Маска подсети: 255.255.255.0

| IP адрес | Имя хоста | Роль | ОС | Сервисы | Открытые порты | Уязвимости |
|----------|-----------|------|----|---------|----------------|------------|
| 192.168.40.10 | jump-server | Jump-сервер | Ubuntu Server 20.04 | SSH, OpenVPN | 22, 1194 | Доступ по паролю, отсутствие 2FA |

## Сетевое оборудование

### Маршрутизаторы и коммутаторы

| Устройство | IP адрес | Модель | Роль | Конфигурация |
|------------|----------|--------|------|--------------|
| Edge Firewall | 192.168.1.1 | pfSense | Пограничный брандмауэр | NAT, Firewall rules |
| Core Router | 192.168.1.10 | Cisco 1921 | Основной маршрутизатор | VLAN routing, ACL |
| Internal Switch | 192.168.20.1 | Cisco Catalyst 2960 | Коммутатор внутренней сети | VLAN 20, Port security |
| DMZ Switch | 192.168.10.1 | Cisco Catalyst 2960 | Коммутатор DMZ | VLAN 10 |
| Dev Switch | 192.168.30.1 | Cisco Catalyst 2960 | Коммутатор сети разработки | VLAN 30 |

### Таблица маршрутизации

| Сеть назначения | Маска | Шлюз | Интерфейс | Метрика |
|-----------------|-------|------|-----------|---------|
| 192.168.10.0 | 255.255.255.0 | 192.168.10.1 | eth0 | 10 |
| 192.168.20.0 | 255.255.255.0 | 192.168.20.1 | eth1 | 10 |
| 192.168.30.0 | 255.255.255.0 | 192.168.30.1 | eth2 | 10 |
| 192.168.40.0 | 255.255.255.0 | 192.168.40.1 | eth3 | 10 |
| 0.0.0.0 | 0.0.0.0 | 192.168.1.1 | eth4 | 1 |

## Правила межсетевого экрана

### DMZ → Internal
- Разрешен: DB Server (3306) от Web Server
- Запрещен: Весь остальной трафик

### Internal → DMZ
- Разрешен: Весь трафик для управления серверами
- Запрещен: Нет ограничений

### Internal → Development
- Разрешен: SSH (22) от разработчиков
- Запрещен: Весь остальной трафик

### Development → Internal
- Разрешен: SSH (22) к серверам разработки
- Запрещен: Доступ к production серверам

### Management → Все сети
- Разрешен: SSH (22), RDP (3389), SNMP (161)
- Запрещен: Весь остальной трафик

## DNS конфигурация

### Внутренние DNS записи

| Имя | Тип | Значение | Зона |
|-----|-----|----------|------|
| techservice.local | A | 192.168.20.20 | techservice.local |
| www.techservice.local | A | 192.168.10.10 | techservice.local |
| mail.techservice.local | A | 192.168.10.20 | techservice.local |
| db.techservice.local | A | 192.168.20.30 | techservice.local |
| files.techservice.local | A | 192.168.20.10 | techservice.local |
| dev.techservice.local | A | 192.168.30.10 | techservice.local |
| test.techservice.local | A | 192.168.30.20 | techservice.local |
| ci.techservice.local | A | 192.168.30.30 | techservice.local |
| backup.techservice.local | A | 192.168.20.40 | techservice.local |
| monitor.techservice.local | A | 192.168.20.50 | techservice.local |

## DHCP конфигурация

### Внутренняя сеть (192.168.20.0/24)
- Диапазон: 192.168.20.100 - 192.168.20.200
- Шлюз: 192.168.20.1
- DNS: 192.168.20.20, 192.168.10.30
- Аренда: 24 часа

### Сеть разработки (192.168.30.0/24)
- Диапазон: 192.168.30.100 - 192.168.30.200
- Шлюз: 192.168.30.1
- DNS: 192.168.20.20
- Аренда: 12 часов

## VLAN конфигурация

| VLAN ID | Имя | Подсеть | Описание |
|---------|-----|---------|----------|
| 10 | DMZ | 192.168.10.0/24 | Публичные сервисы |
| 20 | Internal | 192.168.20.0/24 | Внутренняя сеть |
| 30 | Development | 192.168.30.0/24 | Сеть разработки |
| 40 | Management | 192.168.40.0/24 | Управляющая сеть |
| 99 | Native | 192.168.99.0/24 | Native VLAN |

## Безопасность сети

### Реализованные меры
- ✅ Сегментация сети на VLAN
- ✅ Брандмауэр между сегментами
- ✅ NAT для выхода в интернет
- ✅ Фильтрация портов

### Отсутствующие меры (для обучения)
- ❌ Шифрование трафика между сегментами
- ❌ IDS/IPS система
- ❌ Централизованное логирование
- ❌ Система обнаружения аномалий
- ❌ Двухфакторная аутентификация
- ❌ Регулярные аудиты безопасности

