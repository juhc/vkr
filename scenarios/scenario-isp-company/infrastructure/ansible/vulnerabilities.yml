# Конфигурация уязвимостей для сценария ISP-компании
# Этот файл позволяет включать/отключать уязвимости и изменять настройки машин

# Общие настройки
global:
  # Уровень сложности сценария (beginner, intermediate, advanced)
  difficulty_level: "intermediate"
  
  # Включить/выключить все уязвимости сразу
  enable_all_vulnerabilities: true
  
  # Использовать слабые пароли по умолчанию
  use_weak_passwords: true
  
  # Отключить автоматические обновления
  disable_auto_updates: true

# Уязвимости для клиентских серверов
client_servers:
  pppoe_server:
    ip: "192.168.10.10"
    hostname: "pppoe-server"
    
    vulnerabilities:
      # Слабые пароли
      weak_passwords:
        enabled: true
        root_password: "admin123"
        user_passwords:
          admin: "admin123"
          operator: "operator123"
      
      # Открытые порты управления
      open_management_ports:
        enabled: true
        ssh_from_client_network: true
        web_interface_without_auth: true
        snmp_public_community: "public"
      
      # Небезопасная конфигурация PPPoE
      insecure_pppoe_config:
        enabled: true
        rate_limiting_disabled: true
        unlimited_connections: true
        no_monitoring: true

  dhcp_server:
    ip: "192.168.10.20"
    hostname: "dhcp-server"
    
    vulnerabilities:
      # Отсутствие rate limiting
      no_rate_limiting:
        enabled: true
      
      # Небезопасная конфигурация DHCP
      insecure_dhcp_config:
        enabled: true
        no_authentication: true
        wide_ip_range: true
        no_mac_filtering: true

# Уязвимости для инфраструктурных серверов
infrastructure_servers:
  radius_server:
    ip: "192.168.10.30"
    hostname: "radius-server"
    
    vulnerabilities:
      # Слабый пароль базы данных
      weak_db_password:
        enabled: true
        mysql_password: "radius123"
        remote_db_access: true
        no_encryption: true
      
      # Небезопасная конфигурация RADIUS
      insecure_radius_config:
        enabled: true
        weak_shared_secrets: true
        no_rate_limiting: true
        insecure_auth_methods: true
      
      # Утечка данных клиентов
      client_data_leak:
        enabled: true
        plaintext_passwords: true
        sensitive_data_in_logs: true
        no_encryption: true

  dns_server:
    ip: "192.168.10.40"
    hostname: "dns-server"
    
    vulnerabilities:
      # Открытый рекурсивный DNS
      open_recursive_dns:
        enabled: true
        allow_all_recursive: true
        no_rate_limiting: true
      
      # Небезопасная конфигурация
      insecure_dns_config:
        enabled: true
        open_zone_transfer: true
        no_dns_cache_poisoning_protection: true
        weak_tsig_keys: true
      
      # Раскрытие информации
      information_disclosure:
        enabled: true
        enumerate_internal_hosts: true
        reveal_bind_version: true
        public_zone_info: true

  ntp_server:
    ip: "192.168.10.50"
    hostname: "ntp-server"
    
    vulnerabilities:
      # Открытый доступ
      open_access:
        enabled: true
        allow_all_clients: true
        no_authentication: true
      
      # Небезопасная конфигурация
      insecure_ntp_config:
        enabled: true
        no_rate_limiting: true
        open_monlist: true
        weak_time_sources: true

# Уязвимости для сервисных серверов
service_servers:
  billing_server:
    ip: "192.168.20.10"
    hostname: "billing-server"
    
    vulnerabilities:
      # SQL инъекции
      sql_injection:
        enabled: true
        vulnerable_code: true
        no_prepared_statements: true
        direct_sql_queries: true
      
      # Слабые пароли базы данных
      weak_db_password:
        enabled: true
        postgresql_password: "billing123"
        remote_db_access: true
        no_encryption: true
      
      # Утечка данных клиентов
      client_data_leak:
        enabled: true
        plaintext_personal_data: true
        unencrypted_payment_info: true
        sensitive_data_in_logs: true
      
      # Необновленное ПО
      outdated_software:
        enabled: true
        old_php_version: true
        unpatched_libraries: true
        security_updates_disabled: true

  web_server:
    ip: "192.168.20.20"
    hostname: "web-server"
    
    vulnerabilities:
      # Уязвимая версия WordPress
      vulnerable_wordpress:
        enabled: true
        version: "5.8"
        outdated_plugins: true
        weak_admin_passwords: true
      
      # SQL инъекции
      sql_injection:
        enabled: true
        vulnerable_custom_plugins: true
        no_input_validation: true
        direct_sql_queries: true
      
      # XSS
      xss:
        enabled: true
        unescaped_user_input: true
        no_csp: true
        vulnerable_forms: true
      
      # Небезопасная конфигурация Apache
      insecure_apache_config:
        enabled: true
        server_tokens_full: true
        server_signature_on: true
        open_directories: true

  mail_server:
    ip: "192.168.20.30"
    hostname: "mail-server"
    
    vulnerabilities:
      # Открытый релей
      open_relay:
        enabled: true
        smtp_relay_for_all: true
        no_auth_for_local: true
        spam_possibility: true
      
      # Слабые пароли
      weak_passwords:
        enabled: true
        simple_mailbox_passwords: true
        default_passwords: true
        no_password_policy: true
      
      # Устаревшие протоколы
      outdated_protocols:
        enabled: true
        tls_1_0_support: true
        tls_1_1_support: true
        weak_cipher_suites: true
        no_forced_tls: true

  crm_server:
    ip: "192.168.20.40"
    hostname: "crm-server"
    
    vulnerabilities:
      # Уязвимая версия CRM
      vulnerable_crm:
        enabled: true
        outdated_version: true
        unpatched_components: true
        security_updates_disabled: true
      
      # Слабые пароли администраторов
      weak_admin_passwords:
        enabled: true
        simple_admin_passwords: true
        default_passwords: true
        no_2fa: true
      
      # Утечка данных клиентов
      client_data_leak:
        enabled: true
        plaintext_personal_data: true
        no_encryption: true
        wide_data_access: true

# Уязвимости для управляющих серверов
management_servers:
  monitoring_server:
    ip: "192.168.30.10"
    hostname: "monitoring-server"
    
    vulnerabilities:
      # Слабые SNMP community strings
      weak_snmp_communities:
        enabled: true
        public_community: "public"
        private_community: "private"
        no_encryption: true
      
      # Открытый веб-интерфейс
      open_web_interface:
        enabled: true
        zabbix_no_auth: true
        weak_admin_passwords: true
        infrastructure_info_disclosure: true
      
      # Раскрытие информации
      information_disclosure:
        enabled: true
        sensitive_metrics: true
        unrestricted_logs: true
        network_equipment_info: true

  jump_server:
    ip: "192.168.30.20"
    hostname: "jump-server"
    
    vulnerabilities:
      # Доступ по паролю
      password_access:
        enabled: true
        ssh_password_auth: true
        no_key_auth: true
        weak_user_passwords: true
      
      # Отсутствие 2FA
      no_2fa:
        enabled: true
        two_factor_disabled: true
        password_only_auth: true
        no_bruteforce_protection: true
      
      # Широкий доступ
      wide_access:
        enabled: true
        unrestricted_access: true
        no_session_audit: true
        no_time_restrictions: true

  backup_server:
    ip: "192.168.30.30"
    hostname: "backup-server"
    
    vulnerabilities:
      # SSH доступ по паролю
      ssh_password_auth:
        enabled: true
        key_auth_disabled: true
        weak_passwords: true
        no_bruteforce_protection: true
      
      # Нешифрованные бэкапы
      unencrypted_backups:
        enabled: true
        backups_without_encryption: true
        open_backup_access: true
        sensitive_data_in_backups: true
      
      # Отсутствие контроля доступа
      no_access_control:
        enabled: true
        wide_backup_access: true
        no_access_audit: true
        no_permission_separation: true

# Уязвимости для машины атакующего
attacker_machine:
  kali_linux:
    ip: "192.168.50.10"
    hostname: "kali-attacker"
    
    configuration:
      # Учетные данные по умолчанию
      default_credentials:
        username: "kali"
        password: "kali"
        change_on_deploy: false
      
      # Предустановленные инструменты
      tools:
        scanning: ["nmap", "masscan", "zmap", "netdiscover", "recon-ng"]
        exploitation: ["metasploit", "exploitdb", "searchsploit", "sqlmap", "xsser"]
        web_testing: ["burpsuite", "owasp-zap", "nikto", "dirb", "wfuzz"]
        bruteforce: ["hydra", "medusa", "john", "hashcat", "crunch"]
        traffic_analysis: ["wireshark", "tcpdump", "ettercap", "bettercap"]
        vulnerability_scanning: ["openvas", "lynis", "openscap"]
        social_engineering: ["set"]
        post_exploitation: ["mimikatz", "bloodhound", "powersploit", "empire"]
        wireless: ["aircrack-ng", "reaver", "wifite"]
        other: ["git", "python", "go", "docker"]

# Настройки сетевых уязвимостей
network_vulnerabilities:
  # SNMP уязвимости
  snmp:
    enabled: true
    weak_community_strings: true
    snmp_v1_enabled: true
    snmp_v2c_enabled: true
    no_encryption: true
  
  # Открытые порты
  open_ports:
    enabled: true
    rdp_from_internet: true
    ssh_without_restrictions: true
    web_interfaces_without_auth: true
  
  # Небезопасные протоколы
  insecure_protocols:
    enabled: true
    telnet_instead_ssh: true
    http_instead_https: true
    smbv1_enabled: true
    ntlm_instead_kerberos: true

# Настройки для обучения
learning_settings:
  # Уровень детализации логов
  log_detail_level: "debug"
  
  # Включить подробные сообщения об ошибках
  verbose_error_messages: true
  
  # Сохранять историю команд
  save_command_history: true
  
  # Включить подсказки в системе
  enable_hints: false

