# Конфигурация уязвимостей для сценария ISP-компании
# Этот файл позволяет включать/отключать уязвимости и изменять настройки машин
# Сценарий упрощен и содержит только 5 ключевых машин инфраструктуры

# Общие настройки
global:
  # Уровень сложности сценария (beginner, intermediate, advanced)
  difficulty_level: "intermediate"
  
  # Включить/выключить все уязвимости сразу
  enable_all_vulnerabilities: true
  
  # Использовать слабые пароли по умолчанию
  use_weak_passwords: true
  
  # Отключить автоматические обновления
  disable_auto_updates: true

# Учетные записи администраторов платформы
# Эти учетные записи создаются на всех машинах для доступа администраторов платформы
platform_admins:
  # Основной администратор платформы
  primary_admin:
    username: "platform-admin"
    password: "PlatformAdmin123!"
    ssh_key: ""  # Можно добавить SSH ключ для безопасного доступа
    sudo_access: true
    groups: ["sudo", "adm"]
    shell: "/bin/bash"
    home_directory: "/home/platform-admin"
  
  # Резервный администратор
  backup_admin:
    username: "backup-admin"
    password: "BackupAdmin123!"
    ssh_key: ""
    sudo_access: true
    groups: ["sudo"]
    shell: "/bin/bash"
    home_directory: "/home/backup-admin"
  
  # Настройки доступа
  access_settings:
    # Разрешить SSH доступ по паролю
    ssh_password_auth: true
    # Разрешить SSH доступ по ключам
    ssh_key_auth: true
    # Разрешить root доступ через SSH
    permit_root_login: false
    # Порт SSH
    ssh_port: 22

# Уязвимости для инфраструктурных серверов
infrastructure_servers:
  radius_server:
    ip: "192.168.10.10"
    hostname: "radius-server"
    
    # Учетные записи администраторов платформы
    platform_admins:
      enabled: true
      accounts:
        - username: "{{ platform_admins.primary_admin.username }}"
          password: "{{ platform_admins.primary_admin.password }}"
          sudo_access: true
    
    vulnerabilities:
      # Слабый пароль базы данных
      weak_db_password:
        enabled: true
        mysql_password: "radius123"
        remote_db_access: true
        no_encryption: true
      
      # Небезопасная конфигурация RADIUS
      insecure_radius_config:
        enabled: true
        weak_shared_secrets: true
        no_rate_limiting: true
        insecure_auth_methods: true
      
      # Утечка данных клиентов
      client_data_leak:
        enabled: true
        plaintext_passwords: true
        sensitive_data_in_logs: true
        no_encryption: true

# Уязвимости для сервисных серверов
service_servers:
  billing_server:
    ip: "192.168.20.10"
    hostname: "billing-server"
    
    # Учетные записи администраторов платформы
    platform_admins:
      enabled: true
      accounts:
        - username: "{{ platform_admins.primary_admin.username }}"
          password: "{{ platform_admins.primary_admin.password }}"
          sudo_access: true
    
    vulnerabilities:
      # SQL инъекции
      sql_injection:
        enabled: true
        vulnerable_code: true
        no_prepared_statements: true
        direct_sql_queries: true
      
      # Слабые пароли базы данных
      weak_db_password:
        enabled: true
        postgresql_password: "billing123"
        remote_db_access: true
        no_encryption: true
      
      # Утечка данных клиентов
      client_data_leak:
        enabled: true
        plaintext_personal_data: true
        unencrypted_payment_info: true
        sensitive_data_in_logs: true
      
      # Необновленное ПО
      outdated_software:
        enabled: true
        old_php_version: true
        unpatched_libraries: true
        security_updates_disabled: true

  web_server:
    ip: "192.168.20.20"
    hostname: "web-server"
    
    # Учетные записи администраторов платформы
    platform_admins:
      enabled: true
      accounts:
        - username: "{{ platform_admins.primary_admin.username }}"
          password: "{{ platform_admins.primary_admin.password }}"
          sudo_access: true
    
    vulnerabilities:
      # Уязвимая версия WordPress
      vulnerable_wordpress:
        enabled: true
        version: "5.8"
        outdated_plugins: true
        weak_admin_passwords: true
      
      # SQL инъекции
      sql_injection:
        enabled: true
        vulnerable_custom_plugins: true
        no_input_validation: true
        direct_sql_queries: true
      
      # XSS
      xss:
        enabled: true
        unescaped_user_input: true
        no_csp: true
        vulnerable_forms: true
      
      # Небезопасная конфигурация Apache
      insecure_apache_config:
        enabled: true
        server_tokens_full: true
        server_signature_on: true
        open_directories: true

# Уязвимости для управляющих серверов
management_servers:
  monitoring_server:
    ip: "192.168.30.10"
    hostname: "monitoring-server"
    
    # Учетные записи администраторов платформы
    platform_admins:
      enabled: true
      accounts:
        - username: "platform-admin"
          password: "PlatformAdmin123!"
          sudo_access: true
        - username: "backup-admin"
          password: "BackupAdmin123!"
          sudo_access: true
    
    vulnerabilities:
      # Слабые SNMP community strings
      weak_snmp_communities:
        enabled: true
        public_community: "public"
        private_community: "private"
        no_encryption: true
      
      # Открытый веб-интерфейс
      open_web_interface:
        enabled: true
        zabbix_no_auth: true
        weak_admin_passwords: true
        infrastructure_info_disclosure: true
      
      # Раскрытие информации
      information_disclosure:
        enabled: true
        sensitive_metrics: true
        unrestricted_logs: true
        server_info: true

  jump_server:
    ip: "192.168.30.20"
    hostname: "jump-server"
    
    # Учетные записи администраторов платформы
    platform_admins:
      enabled: true
      accounts:
        - username: "platform-admin"
          password: "PlatformAdmin123!"
          sudo_access: true
        - username: "backup-admin"
          password: "BackupAdmin123!"
          sudo_access: true
    
    vulnerabilities:
      # Доступ по паролю
      password_access:
        enabled: true
        ssh_password_auth: true
        no_key_auth: true
        weak_user_passwords: true
      
      # Отсутствие 2FA
      no_2fa:
        enabled: true
        two_factor_disabled: true
        password_only_auth: true
        no_bruteforce_protection: true
      
      # Широкий доступ
      wide_access:
        enabled: true
        unrestricted_access: true
        no_session_audit: true
        no_time_restrictions: true

# Уязвимости для машины атакующего
attacker_machine:
  kali_linux:
    ip: "192.168.50.10"
    hostname: "kali-attacker"
    
    configuration:
      # Учетные данные по умолчанию
      default_credentials:
        username: "kali"
        password: "kali"
        change_on_deploy: false
      
      # Предустановленные инструменты
      tools:
        scanning: ["nmap", "masscan", "zmap", "netdiscover", "recon-ng"]
        exploitation: ["metasploit", "exploitdb", "searchsploit", "sqlmap", "xsser"]
        web_testing: ["burpsuite", "owasp-zap", "nikto", "dirb", "wfuzz"]
        bruteforce: ["hydra", "medusa", "john", "hashcat", "crunch"]
        traffic_analysis: ["wireshark", "tcpdump", "ettercap", "bettercap"]
        vulnerability_scanning: ["openvas", "lynis", "openscap"]
        social_engineering: ["set"]
        post_exploitation: ["mimikatz", "bloodhound", "powersploit", "empire"]
        wireless: ["aircrack-ng", "reaver", "wifite"]
        other: ["git", "python", "go", "docker"]

# Настройки сетевых уязвимостей
network_vulnerabilities:
  # SNMP уязвимости
  snmp:
    enabled: true
    weak_community_strings: true
    snmp_v1_enabled: true
    snmp_v2c_enabled: true
    no_encryption: true
  
  # Открытые порты
  open_ports:
    enabled: true
    ssh_without_restrictions: true
    web_interfaces_without_auth: true
    database_ports_accessible: true
  
  # Небезопасные протоколы
  insecure_protocols:
    enabled: true
    http_instead_https: true
    no_encryption_for_db: true

# Настройки для обучения
learning_settings:
  # Уровень детализации логов
  log_detail_level: "debug"
  
  # Включить подробные сообщения об ошибках
  verbose_error_messages: true
  
  # Сохранять историю команд
  save_command_history: true
  
  # Включить подсказки в системе
  enable_hints: false
