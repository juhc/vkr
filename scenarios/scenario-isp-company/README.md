# Сценарий: Небольшая ISP компания

## Обзор организации

**Название**: ООО "ИнтернетПлюс"  
**Тип**: Небольшой интернет-провайдер, предоставляющий услуги доступа в интернет  
**Количество сотрудников**: 15-20 человек  
**Количество клиентов**: ~5000 абонентов  
**Сфера деятельности**: Предоставление интернет-услуг, хостинг, доменные имена

## Организационная структура

### Департаменты и роли

#### 1. Руководство
- **Директор** (1 чел.)
  - Учетная запись: `director@internetplus.local`
  - Привилегии: Полный доступ ко всем системам
  - Типичные ошибки: Использование простых паролей, доступ к критичным системам с личных устройств

#### 2. Технический отдел (8 человек)
- **Главный инженер** (1 чел.)
  - Учетная запись: `engineer@internetplus.local`
  - Рабочая станция: Windows 10 Pro
  - Привилегии: Полный доступ к серверам и инфраструктуре
  - Типичные ошибки: Слабые пароли, RDP доступ из интернета, необновленное ПО

- **Системные администраторы** (3 чел.)
  - Учетные записи: `admin1@internetplus.local`, `admin2@internetplus.local`, `admin3@internetplus.local`
  - Рабочие станции: Windows 10 Pro
  - Привилегии: Административные права на серверах
  - Типичные ошибки: Открытые RDP/SSH порты, слабые пароли, необновленное ПО, учетные данные в открытом виде

- **Сетевые инженеры** (2 чел.)
  - Учетные записи: `network1@internetplus.local`, `network2@internetplus.local`
  - Рабочие станции: Windows 10 Pro
  - Привилегии: Доступ к серверам и системам мониторинга
  - Типичные ошибки: Слабые пароли, необновленное ПО, открытые сетевые порты

- **Техническая поддержка** (2 чел.)
  - Учетные записи: `support1@internetplus.local`, `support2@internetplus.local`
  - Рабочие станции: Windows 10 Home/Pro
  - Привилегии: Доступ к системам мониторинга и CRM
  - Типичные ошибки: Доступ к чувствительным данным клиентов, слабые пароли, необновленное ПО

#### 3. Отдел продаж и обслуживания клиентов (5 человек)
- **Менеджеры по продажам** (3 чел.)
  - Учетные записи: `sales1@internetplus.local`, `sales2@internetplus.local`, `sales3@internetplus.local`
  - Рабочие станции: Windows 10 Home/Pro
  - Привилегии: Доступ к CRM системе, ограниченный доступ к биллингу
  - Типичные ошибки: Хранение паролей в открытом виде, доступ к данным других менеджеров, необновленное ПО

- **Менеджеры по работе с клиентами** (2 чел.)
  - Учетные записи: `client1@internetplus.local`, `client2@internetplus.local`
  - Рабочие станции: Windows 10 Home/Pro
  - Привилегии: Доступ к CRM и системам поддержки
  - Типичные ошибки: Утечка данных клиентов, небезопасная передача информации, слабые пароли

#### 4. Бухгалтерия (2 человека)
- **Главный бухгалтер** (1 чел.)
  - Учетная запись: `accountant@internetplus.local`
  - Рабочая станция: Windows 10 Pro
  - Привилегии: Доступ к финансовым системам, биллингу
  - Типичные ошибки: Доступ к финансовым данным с небезопасных устройств, слабые пароли, необновленное ПО

- **Бухгалтер** (1 чел.)
  - Учетная запись: `accountant2@internetplus.local`
  - Рабочая станция: Windows 10 Home/Pro
  - Привилегии: Ограниченный доступ к финансовым системам
  - Типичные ошибки: Слабые пароли, отсутствие двухфакторной аутентификации, необновленное ПО

#### 5. Отдел маркетинга (2 человека)
- **Маркетолог** (1 чел.)
  - Учетная запись: `marketing@internetplus.local`
  - Рабочая станция: Windows 10 Home/Pro
  - Привилегии: Доступ к веб-сайту и системам аналитики
  - Типичные ошибки: Небезопасная конфигурация веб-сайта, слабые пароли

- **Веб-мастер** (1 чел.)
  - Учетная запись: `webmaster@internetplus.local`
  - Рабочая станция: Windows 10 Pro
  - Привилегии: Доступ к веб-серверам и CMS
  - Типичные ошибки: Уязвимые версии CMS, слабые пароли администраторов, необновленное ПО

## Структура сети

### Сетевая топология

```
                    Internet (Upstream)
                          |
                  [Firewall/Gateway]
                          |
        +-----------------+-----------------+-----------------+-----------------+
        |                 |                 |                 |                 |
    [Client]         [Infrastructure]    [Services]       [Management]    [Workstations]
    Network              Network          Network          Network          Network
  (10.0.0.0/8)      (192.168.10.0/24) (192.168.20.0/24) (192.168.30.0/24) (192.168.40.0/24)
        |                 |                 |                 |                 |
    +---+---+         +---+---+         +---+---+         +---+---+         +---+---+
    |       |         |       |         |       |         |       |         |       |
  PPPoE  DHCP    RADIUS  DNS  AD   Billing  Web  Mail  Monitoring  Admin  Win10 Win10
  Server Server  Server Server Server Server Server Server  Server  Server  WS   WS
```

### Сетевые сегменты

#### 1. Клиентская сеть (Client Network) - 10.0.0.0/8
**Назначение**: Подключения клиентов через PPPoE и DHCP  
**Изоляция**: Клиенты изолированы друг от друга

**Устройства**:
- **PPPoE сервер** (192.168.10.10)
  - Роль: Аутентификация и подключение клиентов через PPPoE
  - Сервисы: PPPoE, RADIUS клиент
  - Уязвимости: Слабые пароли администраторов, небезопасная конфигурация

- **DHCP сервер** (192.168.10.20)
  - Роль: Выдача IP адресов клиентам
  - Сервисы: ISC DHCP Server
  - Уязвимости: Отсутствие rate limiting, возможность истощения пула адресов

#### 2. Инфраструктурная сеть (Infrastructure Network) - 192.168.10.0/24
**Назначение**: Критичные сервисы для работы провайдера  
**Изоляция**: Изолирована от клиентской сети

**Устройства**:
- **Active Directory Domain Controller** (192.168.10.30)
  - ОС: Windows Server 2019
  - Роль: Централизованная аутентификация и управление пользователями
  - Сервисы: Active Directory, DNS, DHCP
  - Уязвимости: Слабые пароли администраторов, устаревшие протоколы (SMBv1), необновленное ПО

- **RADIUS сервер** (192.168.10.40)
  - ОС: Ubuntu 20.04 LTS
  - Роль: Аутентификация клиентов
  - Сервисы: FreeRADIUS, MySQL backend
  - Уязвимости: Слабый пароль базы данных, небезопасная конфигурация

- **DNS сервер** (192.168.10.50)
  - ОС: Ubuntu 20.04 LTS
  - Роль: DNS для клиентов и внутренних систем
  - Сервисы: BIND9
  - Уязвимости: Открытый рекурсивный DNS, отсутствие rate limiting

- **NTP сервер** (192.168.10.60)
  - ОС: Ubuntu 20.04 LTS
  - Роль: Синхронизация времени
  - Сервисы: NTPd
  - Уязвимости: Открытый доступ, возможность NTP amplification атак

#### 3. Сервисная сеть (Services Network) - 192.168.20.0/24
**Назначение**: Публичные сервисы для клиентов и сотрудников  
**Изоляция**: Частично изолирована

**Устройства**:
- **Биллинговый сервер** (192.168.20.10)
  - ОС: Windows Server 2019
  - Роль: Управление счетами и платежами клиентов
  - Сервисы: IIS, ASP.NET приложение, SQL Server
  - Уязвимости: Слабые пароли БД, SQL инъекции, необновленное ПО, открытый RDP

- **Веб-сервер** (192.168.20.20)
  - ОС: Ubuntu 20.04 LTS
  - Роль: Корпоративный сайт и клиентский портал
  - Сервисы: Apache, PHP, CMS
  - Уязвимости: Устаревшая версия CMS, SQL инъекции, XSS

- **Почтовый сервер** (192.168.20.30)
  - ОС: Ubuntu 20.04 LTS
  - Роль: Корпоративная почта
  - Сервисы: Postfix, Dovecot
  - Уязвимости: Открытый релей, слабые пароли

- **CRM сервер** (192.168.20.40)
  - ОС: Windows Server 2019
  - Роль: Управление отношениями с клиентами
  - Сервисы: IIS, ASP.NET приложение, SQL Server
  - Уязвимости: Уязвимая версия CRM, слабые пароли администраторов, открытый RDP

#### 4. Управляющая сеть (Management Network) - 192.168.30.0/24
**Назначение**: Управление инфраструктурой  
**Изоляция**: Полностью изолирована

**Устройства**:
- **Сервер мониторинга** (192.168.30.10)
  - ОС: Ubuntu 20.04 LTS
  - Роль: Мониторинг серверов и сервисов
  - Сервисы: Zabbix, SNMP
  - Уязвимости: Слабые SNMP community strings, открытый веб-интерфейс, слабые пароли

- **Jump-сервер** (192.168.30.20)
  - ОС: Ubuntu 20.04 LTS
  - Роль: Точка входа для администраторов
  - Сервисы: SSH, VPN
  - Уязвимости: Доступ по паролю, отсутствие 2FA

- **Сервер резервного копирования** (192.168.30.30)
  - ОС: Ubuntu 20.04 LTS
  - Роль: Резервное копирование всех систем
  - Сервисы: Rsync, BackupPC
  - Уязвимости: Нешифрованные бэкапы, слабые пароли SSH

#### 5. Сеть рабочих станций (Workstations Network) - 192.168.40.0/24
**Назначение**: Рабочие станции сотрудников  
**Изоляция**: Частично изолирована

**Устройства**:
- **Рабочие станции Windows 10** (192.168.40.10-192.168.40.30)
  - ОС: Windows 10 Home/Pro (разные версии)
  - Количество: 20 рабочих станций
  - Роль: Рабочие места сотрудников
  - Уязвимости: Необновленное ПО, отключенный Windows Update, слабые пароли, открытые сетевые порты, отсутствие антивируса, учетные данные в открытом виде

## Типичные уязвимости и ошибки

### Уровень 1: Базовые ошибки конфигурации
1. **Слабые пароли**
   - Простые пароли для учетных записей пользователей
   - Пароли по умолчанию на Windows Server
   - Отсутствие политики сложности паролей в Active Directory
   - Простые пароли для учетных записей клиентов

2. **Открытые порты управления**
   - RDP доступен из интернета (Windows Server)
   - SSH доступен без ограничений
   - Веб-интерфейсы управления без аутентификации
   - Открытые порты на рабочих станциях Windows 10

3. **Необновленное ПО**
   - Устаревшие версии операционных систем (Windows 10 без обновлений)
   - Непатченные уязвимости в Windows Server
   - Отключенные автоматические обновления Windows Update
   - Устаревшие версии приложений

### Уровень 2: Ошибки конфигурации безопасности
4. **Небезопасные протоколы**
   - SMBv1 включен на Windows Server (уязвим к EternalBlue)
   - SNMP v1/v2c (без шифрования)
   - HTTP вместо HTTPS для клиентского портала
   - NTLM вместо Kerberos в Active Directory

5. **Избыточные привилегии**
   - Пользователи с правами администратора без необходимости (локальные админы на Windows 10)
   - Широкий доступ к данным клиентов
   - Неограниченный доступ к биллинговой системе
   - Пользователи в группе Domain Admins без необходимости

6. **Отсутствие мониторинга**
   - Не настроено логирование критичных событий в Windows Event Log
   - Отсутствие алертов на подозрительную активность
   - Нет системы обнаружения вторжений
   - Не настроен аудит доступа к файлам на Windows Server

### Уровень 3: Архитектурные проблемы
7. **Отсутствие сегментации сети**
   - Клиентская сеть имеет доступ к инфраструктурной
   - Отсутствие изоляции между сервисами
   - Нет разделения на production и management сети

8. **Утечки данных клиентов**
   - Данные клиентов в открытом виде в базах данных
   - Резервные копии без шифрования
   - Логи содержат пароли и персональные данные

9. **Отсутствие резервного копирования**
   - Не настроено автоматическое резервное копирование
   - Бэкапы хранятся на том же сервере
   - Нет плана восстановления после сбоев

## Сценарии для обучения

### Сценарий 1: Компрометация RADIUS сервера
**Цель**: Обнаружение и эксплуатация уязвимостей в системе аутентификации  
**Уровень**: Средний  
**Время**: 2-3 часа

### Сценарий 2: Утечка данных клиентов через биллинговую систему
**Цель**: Обнаружение и эксплуатация уязвимостей в биллинге  
**Уровень**: Средний  
**Время**: 2-3 часа

### Сценарий 3: Компрометация через веб-портал клиентов
**Цель**: Обнаружение и эксплуатация уязвимостей веб-приложения  
**Уровень**: Начальный  
**Время**: 1-2 часа

### Сценарий 4: Компрометация Active Directory
**Цель**: Обнаружение и эксплуатация уязвимостей в Active Directory  
**Уровень**: Продвинутый  
**Время**: 3-4 часа

### Сценарий 5: Атака через рабочие станции Windows 10
**Цель**: Компрометация инфраструктуры через уязвимые рабочие станции  
**Уровень**: Средний  
**Время**: 2-3 часа

### Сценарий 6: Комплексная атака - от рабочей станции к критичным системам
**Цель**: Понимание цепочки атаки в инфраструктуре провайдера  
**Уровень**: Продвинутый  
**Время**: 4-5 часов


