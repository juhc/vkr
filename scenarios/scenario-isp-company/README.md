# Сценарий: Небольшая ISP компания

## Обзор организации

**Название**: ООО "ИнтернетПлюс"  
**Тип**: Небольшой интернет-провайдер, предоставляющий услуги доступа в интернет  
**Количество сотрудников**: 15-20 человек  
**Количество клиентов**: ~5000 абонентов  
**Сфера деятельности**: Предоставление интернет-услуг, хостинг, доменные имена

## Организационная структура

### Департаменты и роли

#### 1. Руководство
- **Директор** (1 чел.)
  - Учетная запись: `director@internetplus.local`
  - Привилегии: Полный доступ ко всем системам
  - Типичные ошибки: Использование простых паролей, доступ к критичным системам с личных устройств

#### 2. Технический отдел (8 человек)
- **Главный инженер** (1 чел.)
  - Учетная запись: `engineer@internetplus.local`
  - Привилегии: Полный доступ к сетевому оборудованию и серверам
  - Типичные ошибки: Слабые SNMP community strings, открытые порты управления на оборудовании

- **Системные администраторы** (3 чел.)
  - Учетные записи: `admin1@internetplus.local`, `admin2@internetplus.local`, `admin3@internetplus.local`
  - Привилегии: Административные права на серверах
  - Типичные ошибки: Открытые SSH порты, слабые пароли, необновленное ПО

- **Сетевые инженеры** (2 чел.)
  - Учетные записи: `network1@internetplus.local`, `network2@internetplus.local`
  - Привилегии: Доступ к маршрутизаторам и коммутаторам
  - Типичные ошибки: Небезопасная конфигурация сетевого оборудования, слабые пароли на устройствах

- **Техническая поддержка** (2 чел.)
  - Учетные записи: `support1@internetplus.local`, `support2@internetplus.local`
  - Привилегии: Доступ к системам мониторинга и CRM
  - Типичные ошибки: Доступ к чувствительным данным клиентов, слабые пароли

#### 3. Отдел продаж и обслуживания клиентов (5 человек)
- **Менеджеры по продажам** (3 чел.)
  - Учетные записи: `sales1@internetplus.local`, `sales2@internetplus.local`, `sales3@internetplus.local`
  - Привилегии: Доступ к CRM системе, ограниченный доступ к биллингу
  - Типичные ошибки: Хранение паролей в открытом виде, доступ к данным других менеджеров

- **Менеджеры по работе с клиентами** (2 чел.)
  - Учетные записи: `client1@internetplus.local`, `client2@internetplus.local`
  - Привилегии: Доступ к CRM и системам поддержки
  - Типичные ошибки: Утечка данных клиентов, небезопасная передача информации

#### 4. Бухгалтерия (2 человека)
- **Главный бухгалтер** (1 чел.)
  - Учетная запись: `accountant@internetplus.local`
  - Привилегии: Доступ к финансовым системам, биллингу
  - Типичные ошибки: Доступ к финансовым данным с небезопасных устройств

- **Бухгалтер** (1 чел.)
  - Учетная запись: `accountant2@internetplus.local`
  - Привилегии: Ограниченный доступ к финансовым системам
  - Типичные ошибки: Слабые пароли, отсутствие двухфакторной аутентификации

#### 5. Отдел маркетинга (2 человека)
- **Маркетолог** (1 чел.)
  - Учетная запись: `marketing@internetplus.local`
  - Привилегии: Доступ к веб-сайту и системам аналитики
  - Типичные ошибки: Небезопасная конфигурация веб-сайта

- **Веб-мастер** (1 чел.)
  - Учетная запись: `webmaster@internetplus.local`
  - Привилегии: Доступ к веб-серверам и CMS
  - Типичные ошибки: Уязвимые версии CMS, слабые пароли администраторов

## Структура сети

### Сетевая топология

```
                    Internet (Upstream)
                          |
                  [Border Router]
                          |
                  [Core Router]
                          |
        +-----------------+-----------------+-----------------+-----------------+
        |                 |                 |                 |                 |
    [Client]         [Infrastructure]    [Services]       [Management]      [Attacker]
    Network              Network          Network          Network          Network
  (10.0.0.0/8)      (192.168.10.0/24) (192.168.20.0/24) (192.168.30.0/24) (192.168.50.0/24)
        |                 |                 |                 |                 |
    +---+---+         +---+---+         +---+---+         +---+---+         +---+---+
    |       |         |       |         |       |         |       |         |       |
  PPPoE  DHCP    RADIUS  DNS  Billing  Web  Mail  Monitoring  Admin      Kali Linux
  Server Server  Server Server Server Server Server  Server  Server      Pentest Box
```

### Сетевые сегменты

#### 1. Клиентская сеть (Client Network) - 10.0.0.0/8
**Назначение**: Подключения клиентов через PPPoE и DHCP  
**Изоляция**: Клиенты изолированы друг от друга

**Устройства**:
- **PPPoE сервер** (192.168.10.10)
  - Роль: Аутентификация и подключение клиентов через PPPoE
  - Сервисы: PPPoE, RADIUS клиент
  - Уязвимости: Слабые пароли администраторов, небезопасная конфигурация

- **DHCP сервер** (192.168.10.20)
  - Роль: Выдача IP адресов клиентам
  - Сервисы: ISC DHCP Server
  - Уязвимости: Отсутствие rate limiting, возможность истощения пула адресов

#### 2. Инфраструктурная сеть (Infrastructure Network) - 192.168.10.0/24
**Назначение**: Критичные сервисы для работы провайдера  
**Изоляция**: Изолирована от клиентской сети

**Устройства**:
- **RADIUS сервер** (192.168.10.30)
  - Роль: Аутентификация клиентов
  - Сервисы: FreeRADIUS, MySQL backend
  - Уязвимости: Слабый пароль базы данных, небезопасная конфигурация

- **DNS сервер** (192.168.10.40)
  - Роль: DNS для клиентов и внутренних систем
  - Сервисы: BIND9
  - Уязвимости: Открытый рекурсивный DNS, отсутствие rate limiting

- **NTP сервер** (192.168.10.50)
  - Роль: Синхронизация времени
  - Сервисы: NTPd
  - Уязвимости: Открытый доступ, возможность NTP amplification атак

#### 3. Сервисная сеть (Services Network) - 192.168.20.0/24
**Назначение**: Публичные сервисы для клиентов и сотрудников  
**Изоляция**: Частично изолирована

**Устройства**:
- **Биллинговый сервер** (192.168.20.10)
  - Роль: Управление счетами и платежами клиентов
  - Сервисы: Биллинговая система, PostgreSQL
  - Уязвимости: Слабые пароли БД, SQL инъекции, необновленное ПО

- **Веб-сервер** (192.168.20.20)
  - Роль: Корпоративный сайт и клиентский портал
  - Сервисы: Apache/Nginx, PHP, CMS
  - Уязвимости: Устаревшая версия CMS, SQL инъекции, XSS

- **Почтовый сервер** (192.168.20.30)
  - Роль: Корпоративная почта
  - Сервисы: Postfix, Dovecot
  - Уязвимости: Открытый релей, слабые пароли

- **CRM сервер** (192.168.20.40)
  - Роль: Управление отношениями с клиентами
  - Сервисы: CRM система, веб-интерфейс
  - Уязвимости: Уязвимая версия CRM, слабые пароли администраторов

#### 4. Управляющая сеть (Management Network) - 192.168.30.0/24
**Назначение**: Управление инфраструктурой  
**Изоляция**: Полностью изолирована

**Устройства**:
- **Сервер мониторинга** (192.168.30.10)
  - Роль: Мониторинг сетевого оборудования и серверов
  - Сервисы: Zabbix, SNMP
  - Уязвимости: Слабые SNMP community strings, открытый веб-интерфейс

- **Jump-сервер** (192.168.30.20)
  - Роль: Точка входа для администраторов
  - Сервисы: SSH, VPN
  - Уязвимости: Доступ по паролю, отсутствие 2FA

- **Сервер резервного копирования** (192.168.30.30)
  - Роль: Резервное копирование всех систем
  - Сервисы: Rsync, BackupPC
  - Уязвимости: Нешифрованные бэкапы, слабые пароли SSH

#### 5. Сеть атакующего (Attacker Network) - 192.168.50.0/24
**Назначение**: Машина для проведения тестирования на проникновение  
**Изоляция**: Отдельная сеть с доступом ко всем тестируемым сетям

**Устройства**:
- **Kali Linux Pentest Box** (192.168.50.10)
  - ОС: Kali Linux (последняя версия)
  - Роль: Машина атакующего для проведения пентеста
  - Сервисы: Предустановленные инструменты для тестирования на проникновение
  - Доступ: Доступ ко всем сетям инфраструктуры для тестирования
  - Инструменты: Nmap, Metasploit, Burp Suite, SQLMap, Hydra, John the Ripper, Wireshark и др.

## Типичные уязвимости и ошибки

### Уровень 1: Базовые ошибки конфигурации
1. **Слабые пароли**
   - Пароли по умолчанию на сетевом оборудовании
   - Простые пароли для учетных записей клиентов
   - Отсутствие политики сложности паролей

2. **Открытые порты управления**
   - SNMP доступен из интернета
   - Telnet вместо SSH на сетевом оборудовании
   - Веб-интерфейсы управления без аутентификации

3. **Необновленное ПО**
   - Устаревшие версии операционных систем
   - Непатченные уязвимости в биллинговой системе
   - Отключенные автоматические обновления

### Уровень 2: Ошибки конфигурации безопасности
4. **Небезопасные протоколы**
   - Использование Telnet для управления оборудованием
   - SNMP v1/v2c (без шифрования)
   - HTTP вместо HTTPS для клиентского портала

5. **Избыточные привилегии**
   - Пользователи с правами администратора без необходимости
   - Широкий доступ к данным клиентов
   - Неограниченный доступ к биллинговой системе

6. **Отсутствие мониторинга**
   - Не настроено логирование критичных событий
   - Отсутствие алертов на подозрительную активность
   - Нет системы обнаружения вторжений

### Уровень 3: Архитектурные проблемы
7. **Отсутствие сегментации сети**
   - Клиентская сеть имеет доступ к инфраструктурной
   - Отсутствие изоляции между сервисами
   - Нет разделения на production и management сети

8. **Утечки данных клиентов**
   - Данные клиентов в открытом виде в базах данных
   - Резервные копии без шифрования
   - Логи содержат пароли и персональные данные

9. **Отсутствие резервного копирования**
   - Не настроено автоматическое резервное копирование
   - Бэкапы хранятся на том же сервере
   - Нет плана восстановления после сбоев

## Сценарии для обучения

### Сценарий 1: Компрометация RADIUS сервера
**Цель**: Обнаружение и эксплуатация уязвимостей в системе аутентификации  
**Уровень**: Средний  
**Время**: 2-3 часа

### Сценарий 2: Утечка данных клиентов через биллинговую систему
**Цель**: Обнаружение и эксплуатация уязвимостей в биллинге  
**Уровень**: Средний  
**Время**: 2-3 часа

### Сценарий 3: Компрометация через веб-портал клиентов
**Цель**: Обнаружение и эксплуатация уязвимостей веб-приложения  
**Уровень**: Начальный  
**Время**: 1-2 часа

### Сценарий 4: Атака на сетевую инфраструктуру через SNMP
**Цель**: Обнаружение и эксплуатация небезопасной конфигурации SNMP  
**Уровень**: Продвинутый  
**Время**: 3-4 часа

### Сценарий 5: Комплексная атака - от клиента к критичным системам
**Цель**: Понимание цепочки атаки в инфраструктуре провайдера  
**Уровень**: Продвинутый  
**Время**: 4-5 часов


