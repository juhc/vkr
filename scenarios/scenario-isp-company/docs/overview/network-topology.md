# Детальная сетевая топология ISP компании

## Схема сети

```
                            Internet (Upstream Providers)
                                    |
                            [Firewall/Gateway]
                                    |
        +---------------------------+---------------------------+---------------------------+
        |                           |                           |                           |
    [Infrastructure]            [Services]                  [Management]                  [Attacker]
        Network                    Network                    Network                    Network
  (192.168.10.0/24)          (192.168.20.0/24)          (192.168.30.0/24)          (192.168.50.0/24)
        |                           |                           |                           |
    +---+---+                   +---+---+                   +---+---+               +---+---+
    |       |                   |       |                   |       |               |       |
  RADIUS              Services              Management         Admin            Kali Linux
  Server              Server                Server            Workstation       Pentest Box
                      (Billing+Web)         (Monitor+Jump)
```

## Детальное описание сетевых сегментов

### Инфраструктурная сеть (Infrastructure Network) - 192.168.10.0/24

#### Назначение
Критичные сервисы для работы провайдера: аутентификация клиентов.

#### Шлюз: 192.168.10.1
#### Маска подсети: 255.255.255.0

| IP адрес | Имя хоста | Роль | ОС | Сервисы | Открытые порты | Уязвимости |
|----------|-----------|------|----|---------|----------------|------------|
| 192.168.10.10 | radius-server | RADIUS сервер | Ubuntu 20.04 | FreeRADIUS, MySQL | 1812, 1813, 3306 | Слабые пароли ОС, устаревшая ОС, открытые порты управления, небезопасная конфигурация SSH, неправильные права доступа к файлам |

**Правила брандмауэра инфраструктурной сети**:
- Разрешен входящий трафик: Только от сервисных серверов (для аутентификации)
- Разрешен исходящий трафик: Весь (для синхронизации и обновлений)
- Разрешен доступ из управляющей сети: Да (для администрирования)
- Запрещен доступ из интернета: Да

---

### Сервисная сеть (Services Network) - 192.168.20.0/24

#### Назначение
Публичные сервисы для клиентов: биллинг и веб-сайт.

#### Шлюз: 192.168.20.1
#### Маска подсети: 255.255.255.0

| IP адрес | Имя хоста | Роль | ОС | Сервисы | Открытые порты | Уязвимости |
|----------|-----------|------|----|---------|----------------|------------|
| 192.168.20.10 | services-server | Сервер сервисов (Биллинг + Веб) | Ubuntu 20.04 | Apache, PHP, PostgreSQL, WordPress | 80, 443, 5432, 8080 | Слабые пароли ОС, устаревшая ОС, открытые порты управления, небезопасная конфигурация SSH, неправильные права доступа к файлам, отключенные механизмы безопасности |

**Правила брандмауэра сервисной сети**:
- Разрешен входящий трафик из интернета: 80, 443 (веб-сервер, биллинг)
- Разрешен входящий трафик из внутренней сети: Весь (для сотрудников)
- Разрешен исходящий трафик: Весь
- Разрешен доступ к инфраструктурной сети: Да (для аутентификации через RADIUS)

---

### Управляющая сеть (Management Network) - 192.168.30.0/24

#### Назначение
Управление инфраструктурой: мониторинг и администрирование.

#### Шлюз: 192.168.30.1
#### Маска подсети: 255.255.255.0

| IP адрес | Имя хоста | Роль | ОС | Сервисы | Открытые порты | Уязвимости |
|----------|-----------|------|----|---------|----------------|------------|
| 192.168.30.10 | management-server | Сервер управления (Мониторинг + Jump) | Ubuntu 20.04 | Zabbix, SNMP, SSH, OpenVPN | 80, 443, 10051, 161, 22, 1194 | Слабые пароли ОС, устаревшая ОС, открытые порты управления, небезопасная конфигурация SSH, неправильные права доступа к файлам, отключенные механизмы безопасности, отсутствие 2FA |
| 192.168.30.20 | admin-workstation | Компьютер администратора | Ubuntu 20.04 Desktop | SSH, RDP, SMB, FTP | 22, 3389, 445, 21 | Слабые пароли ОС, устаревшая ОС, открытые порты управления, небезопасная конфигурация SSH, неправильные права доступа к файлам, отключенные механизмы безопасности (брандмауэр, антивирус) |

**Правила брандмауэра управляющей сети**:
- Разрешен входящий трафик: Только из доверенных сетей
- Разрешен исходящий трафик: Весь (для мониторинга и управления)
- Запрещен доступ из других сетей: Да (полная изоляция)

---

### Сеть атакующего (Attacker Network) - 192.168.50.0/24

#### Назначение
Машина для проведения тестирования на проникновение и обучения навыкам кибербезопасности.

#### Шлюз: 192.168.50.1
#### Маска подсети: 255.255.255.0

| IP адрес | Имя хоста | Роль | ОС | Сервисы | Открытые порты | Описание |
|----------|-----------|------|----|---------|----------------|----------|
| 192.168.50.10 | kali-attacker | Машина атакующего | Kali Linux (последняя версия) | Инструменты для пентеста | 22 (SSH), 80 (HTTP для веб-интерфейсов инструментов) | Предустановленные инструменты для тестирования на проникновение |

**Предустановленные инструменты**:
- **Сканирование и разведка**: Nmap, Masscan, Zmap, Netdiscover, Recon-ng
- **Эксплуатация**: Metasploit Framework, ExploitDB, SearchSploit, SQLMap, XSSer
- **Веб-тестирование**: Burp Suite, OWASP ZAP, Nikto, Dirb/Dirbuster, Wfuzz
- **Брутфорс**: Hydra, Medusa, John the Ripper, Hashcat, Crunch
- **Анализ трафика**: Wireshark, Tcpdump, Ettercap, Bettercap
- **Анализ уязвимостей**: OpenVAS, Nessus (если доступен), Lynis, OpenSCAP
- **Социальная инженерия**: Social Engineering Toolkit (SET)
- **Пост-эксплуатация**: Mimikatz, BloodHound, PowerSploit, Empire
- **Беспроводные сети**: Aircrack-ng, Reaver, Wifite
- **Другие**: Git, Python, Go, Docker

**Доступ к сетям**:
- Разрешен доступ ко всем тестируемым сетям (Infrastructure, Services, Management)
- Разрешен доступ в интернет (для скачивания обновлений и инструментов)
- Разрешен исходящий трафик: Весь

**Правила брандмауэра сети атакующего**:
- Разрешен входящий трафик: Только установленные соединения (для обратных оболочек)
- Разрешен исходящий трафик: Весь (для проведения атак)
- Разрешен доступ ко всем тестируемым сетям: Да
- Разрешен доступ в интернет: Да

**Учетные данные по умолчанию**:
- Пользователь: `kali` или `root`
- Пароль: `kali` (рекомендуется изменить при развертывании)

---

## Правила межсетевого экрана

### Инфраструктурная сеть → Сервисная сеть
- Разрешен: RADIUS запросы (1812, 1813) от сервисных серверов
- Запрещен: Весь остальной трафик

### Сервисная сеть → Инфраструктурная сеть
- Разрешен: RADIUS запросы (1812, 1813) для аутентификации
- Запрещен: Весь остальной трафик

### Управляющая сеть → Все сети
- Разрешен: SSH (22), SNMP (161)
- Разрешен: Веб-доступ к системам мониторинга
- Запрещен: Весь остальной трафик

### Сеть атакующего → Все сети
- Разрешен: Весь трафик (для проведения тестирования на проникновение)
- Разрешен: Доступ к инфраструктурной сети (для тестирования RADIUS)
- Разрешен: Доступ к сервисной сети (для тестирования веб-приложений и биллинга)
- Разрешен: Доступ к управляющей сети (для тестирования систем управления)
- Разрешен: Доступ в интернет (для скачивания инструментов и обновлений)

---

## DNS конфигурация

### Внутренние DNS записи

| Имя | Тип | Значение | Зона | Описание |
|-----|-----|----------|------|----------|
| internetplus.local | A | 192.168.20.20 | internetplus.local | Основной домен |
| www.internetplus.local | A | 192.168.20.20 | internetplus.local | Веб-сайт |
| billing.internetplus.local | A | 192.168.20.10 | internetplus.local | Биллинг |
| radius.internetplus.local | A | 192.168.10.10 | internetplus.local | RADIUS |
| monitor.internetplus.local | A | 192.168.30.10 | internetplus.local | Мониторинг |

### Публичные DNS записи

| Имя | Тип | Значение | Описание |
|-----|-----|----------|----------|
| internetplus.ru | A | 203.0.113.10 | Основной домен |
| www.internetplus.ru | A | 203.0.113.10 | Веб-сайт |

---

## DHCP конфигурация

### Инфраструктурная сеть (192.168.10.0/24)
- Диапазон: 192.168.10.100 - 192.168.10.200
- Шлюз: 192.168.10.1
- DNS: 8.8.8.8, 8.8.4.4
- Аренда: 12 часов

### Сервисная сеть (192.168.20.0/24)
- Диапазон: 192.168.20.100 - 192.168.20.200
- Шлюз: 192.168.20.1
- DNS: 8.8.8.8, 8.8.4.4
- Аренда: 12 часов

### Управляющая сеть (192.168.30.0/24)
- Диапазон: 192.168.30.100 - 192.168.30.200
- Шлюз: 192.168.30.1
- DNS: 8.8.8.8, 8.8.4.4
- Аренда: 8 часов

---

## Безопасность сети

### Реализованные меры
- ✅ Сегментация сети на подсети
- ✅ Брандмауэр между сегментами
- ✅ NAT для выхода в интернет
- ✅ Изоляция управляющей сети

### Отсутствующие меры (для обучения)
- ❌ Шифрование трафика между сегментами
- ❌ IDS/IPS система
- ❌ Централизованное логирование
- ❌ Система обнаружения аномалий
- ❌ Двухфакторная аутентификация
- ❌ Регулярные аудиты безопасности
- ❌ Защита от DDoS атак
- ❌ Мониторинг сетевого трафика

---

## Специфика ISP инфраструктуры

### Аутентификация клиентов
- **RADIUS**: Централизованная аутентификация клиентов провайдера
- **База данных**: Хранение учетных записей клиентов
- **Тарифы**: Различные скорости и лимиты трафика

### Мониторинг
- **Zabbix**: Мониторинг серверов и сервисов
- **SNMP**: Мониторинг систем
- **Логирование**: Централизованное логирование событий

---

## Навигация

- **[← Назад к главной](../../README.md)** - главная страница с навигацией
- **[Обзор сценария](README.md)** - описание организации и сети
- **[Сценарии машин](machine-scenarios.md)** - описание каждой машины
- **[Развертывание](../deployment/QUICKSTART.md)** - руководство по развертыванию
