# Сценарии для виртуальных машин ISP компании

## Обзор сценариев

Каждый сервер в инфраструктуре ISP компании настроен с определенными уязвимостями и ошибками конфигурации для практического обучения. Ниже описаны сценарии для каждой машины с учетом специфики интернет-провайдера.

## Клиентские серверы

### 1. PPPoE Server (192.168.10.10)

#### Описание
Сервер для подключения клиентов через протокол PPPoE (Point-to-Point Protocol over Ethernet).

#### Конфигурация
- **ОС**: Ubuntu 20.04 LTS
- **PPPoE**: pppd, rp-pppoe
- **RADIUS клиент**: Настроен для аутентификации
- **Порты**: 1723 (PPTP), 1812, 1813 (RADIUS)

#### Уязвимости
1. **Слабые пароли администраторов**
   - Пароль root: `admin123`
   - Простые пароли для пользователей
   - Отсутствие политики сложности паролей

2. **Небезопасная конфигурация PPPoE**
   - Отсутствие rate limiting
   - Неограниченное количество одновременных подключений
   - Отсутствие мониторинга подозрительной активности

3. **Открытые порты управления**
   - SSH доступен из клиентской сети
   - Веб-интерфейс без аутентификации
   - SNMP с публичным community string

#### Сценарий обучения
1. **Обнаружение**
   - Сканирование портов PPPoE сервера
   - Обнаружение открытых портов управления
   - Тестирование доступа к серверу

2. **Эксплуатация**
   - Доступ к серверу через слабые пароли
   - Модификация конфигурации PPPoE
   - Перехват учетных данных клиентов

3. **Устранение**
   - Изменение паролей администраторов
   - Настройка rate limiting
   - Ограничение доступа к портам управления

---

### 2. DHCP Server (192.168.10.20)

#### Описание
Сервер для выдачи IP адресов клиентам через протокол DHCP.

#### Конфигурация
- **ОС**: Ubuntu 20.04 LTS
- **DHCP**: ISC DHCP Server 4.4
- **Порты**: 67, 68 (UDP)

#### Уязвимости
1. **Отсутствие rate limiting**
   - Возможность истощения пула IP адресов
   - DHCP starvation атаки
   - Отсутствие защиты от злонамеренных запросов

2. **Небезопасная конфигурация**
   - Отсутствие аутентификации DHCP запросов
   - Широкий диапазон IP адресов
   - Отсутствие резервирования для критичных устройств

3. **Открытые порты**
   - DHCP порты доступны из клиентской сети
   - Отсутствие фильтрации по MAC адресам
   - Нет защиты от rogue DHCP серверов

#### Сценарий обучения
1. **Обнаружение**
   - Обнаружение DHCP сервера в сети
   - Анализ конфигурации
   - Тестирование DHCP запросов

2. **Эксплуатация**
   - Истощение пула IP адресов
   - Установка rogue DHCP сервера
   - Перехват сетевого трафика

3. **Устранение**
   - Настройка rate limiting
   - Резервирование IP адресов
   - Защита от rogue DHCP серверов

---

## Инфраструктурные серверы

### 3. Active Directory Domain Controller (192.168.10.30)

#### Описание
Domain Controller для централизованной аутентификации и управления пользователями в домене.

#### Конфигурация
- **ОС**: Windows Server 2019
- **Роль**: Active Directory Domain Services, DNS, DHCP
- **Домен**: internetplus.local
- **Порты**: 53 (DNS), 88 (Kerberos), 135 (RPC), 389 (LDAP), 445 (SMB), 636 (LDAPS), 3268 (GC), 3269 (GC-SSL), 3389 (RDP)

#### Уязвимости
1. **Слабые пароли администраторов**
   - Пароль Administrator: `Admin123!`
   - Простые пароли для других администраторов
   - Отсутствие политики сложности паролей в GPO

2. **Устаревшие протоколы**
   - SMBv1 включен (уязвим к EternalBlue)
   - NTLM используется вместо Kerberos
   - LDAP без шифрования
   - Отсутствие LDAP signing

3. **Небезопасная конфигурация**
   - Открытый RDP (3389) из интернета
   - Слабые настройки групповых политик
   - Пользователи в группе Domain Admins без необходимости
   - Отсутствие аудита доступа

4. **Необновленное ПО**
   - Устаревшие обновления безопасности
   - Отключенные автоматические обновления
   - Уязвимые версии служб

#### Сценарий обучения
1. **Обнаружение**
   - Обнаружение Domain Controller через порт 389 (LDAP)
   - Перечисление пользователей через LDAP
   - Обнаружение SMBv1 через сканирование портов
   - Тестирование RDP доступа

2. **Эксплуатация**
   - Эксплуатация EternalBlue (SMBv1) для получения доступа
   - Брутфорс паролей администраторов через RDP
   - Извлечение хешей паролей через DCSync
   - Pass-the-Hash атаки
   - Kerberoasting для получения TGT

3. **Устранение**
   - Отключение SMBv1
   - Включение LDAP signing
   - Настройка политики сложности паролей
   - Ограничение доступа RDP
   - Удаление пользователей из Domain Admins
   - Включение аудита доступа

---

### 4. RADIUS Server (192.168.10.40)

#### Описание
Сервер для аутентификации клиентов при подключении к сети провайдера.

#### Конфигурация
- **ОС**: Ubuntu 20.04 LTS
- **RADIUS**: FreeRADIUS 3.0
- **Backend**: MySQL 5.7
- **Порты**: 1812 (authentication), 1813 (accounting), 3306 (MySQL)

#### Уязвимости
1. **Слабый пароль базы данных**
   - Пароль MySQL: `radius123`
   - Удаленный доступ к БД разрешен
   - Отсутствие шифрования соединений

2. **Небезопасная конфигурация RADIUS**
   - Слабые shared secrets для клиентов
   - Отсутствие rate limiting
   - Небезопасные методы аутентификации

3. **Утечка данных клиентов**
   - Пароли клиентов в открытом виде в БД
   - Логи содержат чувствительную информацию
   - Отсутствие шифрования данных

#### Сценарий обучения
1. **Обнаружение**
   - Обнаружение RADIUS сервера
   - Тестирование подключения к MySQL
   - Анализ конфигурации FreeRADIUS

2. **Эксплуатация**
   - Подключение к базе данных с слабым паролем
   - Извлечение учетных данных клиентов
   - Модификация записей клиентов

3. **Устранение**
   - Изменение пароля базы данных
   - Шифрование паролей клиентов
   - Ограничение доступа к БД

---

### 5. DNS Server (192.168.10.50)

#### Описание
DNS сервер для разрешения имен для клиентов и внутренних систем.

#### Конфигурация
- **ОС**: Ubuntu 20.04 LTS
- **DNS**: BIND9 9.16
- **Порт**: 53 (UDP/TCP)

#### Уязвимости
1. **Открытый рекурсивный DNS**
   - Рекурсивные запросы разрешены для всех
   - Возможность использования для DNS amplification атак
   - Отсутствие rate limiting

2. **Небезопасная конфигурация**
   - Открытая зона для перечисления
   - Отсутствие защиты от DNS cache poisoning
   - Слабые TSIG ключи

3. **Раскрытие информации**
   - Перечисление внутренних хостов через DNS
   - Раскрытие версии BIND
   - Информация о зонах доступна публично

#### Сценарий обучения
1. **Обнаружение**
   - Тестирование рекурсивных запросов
   - Проверка конфигурации BIND
   - Перечисление зон

2. **Эксплуатация**
   - Использование для DNS amplification атак
   - Перечисление внутренних хостов
   - DNS cache poisoning

3. **Устранение**
   - Ограничение рекурсивных запросов
   - Настройка rate limiting
   - Защита зон

---

### 6. NTP Server (192.168.10.60)

#### Описание
Сервер синхронизации времени для клиентов и внутренних систем.

#### Конфигурация
- **ОС**: Ubuntu 20.04 LTS
- **NTP**: NTPd 4.2.8
- **Порт**: 123 (UDP)

#### Уязвимости
1. **Открытый доступ**
   - NTP доступен для всех клиентов
   - Возможность использования для NTP amplification атак
   - Отсутствие аутентификации

2. **Небезопасная конфигурация**
   - Отсутствие rate limiting
   - Открытые monlist запросы
   - Слабые источники времени

#### Сценарий обучения
1. **Обнаружение**
   - Обнаружение NTP сервера
   - Тестирование monlist запросов
   - Проверка конфигурации

2. **Эксплуатация**
   - Использование для NTP amplification атак
   - Манипуляция временем
   - DoS атаки

3. **Устранение**
   - Ограничение доступа
   - Отключение monlist
   - Настройка rate limiting

---

## Сервисные серверы

### 7. Billing Server (192.168.20.10)

#### Описание
Биллинговая система для управления счетами и платежами клиентов.

#### Конфигурация
- **ОС**: Windows Server 2019
- **Веб-сервер**: IIS 10.0
- **Приложение**: ASP.NET
- **База данных**: SQL Server 2019
- **Порты**: 80, 443, 1433 (SQL Server), 3389 (RDP)

#### Уязвимости
1. **SQL инъекции**
   - Уязвимый код обработки пользовательского ввода
   - Отсутствие prepared statements
   - Прямые SQL запросы с пользовательскими данными

2. **Слабые пароли базы данных**
   - Пароль SQL Server SA: `SqlServer123!`
   - Удаленный доступ к SQL Server разрешен
   - Отсутствие шифрования соединений

3. **Утечка данных клиентов**
   - Персональные данные в открытом виде
   - Платежная информация не зашифрована
   - Логи содержат чувствительные данные

4. **Необновленное ПО**
   - Устаревшие версии .NET Framework
   - Непатченные библиотеки
   - Отключенные автоматические обновления Windows

5. **Открытый RDP**
   - RDP доступен из интернета
   - Слабые пароли администраторов
   - Отсутствие защиты от брутфорса

#### Сценарий обучения
1. **Обнаружение**
   - Анализ веб-приложения биллинга
   - Обнаружение SQL инъекций
   - Тестирование подключения к SQL Server
   - Обнаружение открытого RDP

2. **Эксплуатация**
   - Эксплуатация SQL инъекций
   - Подключение к SQL Server с слабым паролем
   - Извлечение данных клиентов
   - Модификация счетов и платежей
   - Доступ через RDP

3. **Устранение**
   - Исправление SQL инъекций
   - Шифрование данных клиентов
   - Обновление ПО
   - Ограничение доступа RDP
   - Настройка безопасной конфигурации SQL Server

---

#### Описание
Биллинговая система для управления счетами и платежами клиентов.

#### Конфигурация
- **ОС**: Ubuntu 20.04 LTS
- **Биллинг**: Проприетарная система на PHP
- **База данных**: PostgreSQL 12
- **Порты**: 80, 443, 5432

#### Уязвимости
1. **SQL инъекции**
   - Уязвимый код обработки пользовательского ввода
   - Отсутствие prepared statements
   - Прямые SQL запросы с пользовательскими данными

2. **Слабые пароли базы данных**
   - Пароль PostgreSQL: `billing123`
   - Удаленный доступ к БД разрешен
   - Отсутствие шифрования соединений

3. **Утечка данных клиентов**
   - Персональные данные в открытом виде
   - Платежная информация не зашифрована
   - Логи содержат чувствительные данные

4. **Необновленное ПО**
   - Устаревшая версия PHP с известными уязвимостями
   - Непатченные библиотеки
   - Отсутствие обновлений безопасности

#### Сценарий обучения
1. **Обнаружение**
   - Анализ веб-приложения биллинга
   - Обнаружение SQL инъекций
   - Тестирование подключения к БД

2. **Эксплуатация**
   - Эксплуатация SQL инъекций
   - Извлечение данных клиентов
   - Модификация счетов и платежей

3. **Устранение**
   - Исправление SQL инъекций
   - Шифрование данных клиентов
   - Обновление ПО

---

### 8. Web Server (192.168.20.20)

#### Описание
Веб-сервер для корпоративного сайта и клиентского портала.

#### Конфигурация
- **ОС**: Ubuntu 20.04 LTS
- **Веб-сервер**: Apache 2.4.41
- **PHP**: 7.4
- **CMS**: WordPress 5.8 (уязвимая версия)
- **Порты**: 80, 443, 8080

#### Уязвимости
1. **Уязвимая версия WordPress**
   - WordPress 5.8 с известными уязвимостями
   - Устаревшие плагины
   - Слабые пароли администраторов

2. **SQL инъекции**
   - Уязвимый код в кастомных плагинах
   - Отсутствие валидации входных данных
   - Прямые SQL запросы

3. **XSS (Cross-Site Scripting)**
   - Неэкранированный пользовательский ввод
   - Отсутствие Content Security Policy
   - Уязвимости в формах обратной связи

4. **Небезопасная конфигурация Apache**
   - `ServerTokens Full` - раскрытие версии
   - `ServerSignature On` - раскрытие информации
   - Открытые директории без индексов

#### Сценарий обучения
1. **Обнаружение**
   - Сканирование версий WordPress и плагинов
   - Обнаружение SQL инъекций и XSS
   - Анализ конфигурации Apache

2. **Эксплуатация**
   - Эксплуатация уязвимостей WordPress
   - SQL инъекции для извлечения данных
   - XSS для кражи сессий

3. **Устранение**
   - Обновление WordPress и плагинов
   - Исправление SQL инъекций и XSS
   - Исправление конфигурации Apache

---

### 9. Mail Server (192.168.20.30)

#### Описание
Почтовый сервер для корпоративной почты и почты клиентов.

#### Конфигурация
- **ОС**: Ubuntu 20.04 LTS
- **MTA**: Postfix 3.4
- **MDA**: Dovecot 2.3
- **Порты**: 25, 587 (SMTP), 993, 995 (IMAP/POP3)

#### Уязвимости
1. **Открытый релей**
   - SMTP релей разрешен для всех
   - Отсутствие аутентификации для локальных пользователей
   - Возможность рассылки спама

2. **Слабые пароли**
   - Простые пароли для почтовых ящиков
   - Пароли по умолчанию
   - Отсутствие политики сложности паролей

3. **Устаревшие протоколы**
   - Поддержка TLS 1.0 и 1.1
   - Слабые cipher suites
   - Отсутствие обязательного TLS

#### Сценарий обучения
1. **Обнаружение**
   - Тестирование конфигурации SMTP
   - Проверка возможности открытого релея
   - Анализ конфигурационных файлов

2. **Эксплуатация**
   - Использование открытого релея для рассылки спама
   - Перехват почтового трафика
   - Брутфорс паролей почтовых ящиков

3. **Устранение**
   - Настройка правильной конфигурации SMTP
   - Включение аутентификации
   - Обновление TLS до версии 1.2+

---

### 10. CRM Server (192.168.20.40)

#### Описание
CRM система для управления отношениями с клиентами.

#### Конфигурация
- **ОС**: Windows Server 2019
- **Веб-сервер**: IIS 10.0
- **Приложение**: ASP.NET
- **База данных**: SQL Server 2019
- **Порты**: 80, 443, 1433 (SQL Server), 3389 (RDP)

#### Уязвимости
1. **Уязвимая версия CRM**
   - Устаревшая версия с известными уязвимостями
   - Непатченные компоненты
   - Отсутствие обновлений безопасности

2. **Слабые пароли администраторов**
   - Простые пароли для учетных записей администраторов
   - Пароли по умолчанию
   - Отсутствие двухфакторной аутентификации

3. **Утечка данных клиентов**
   - Персональные данные в открытом виде
   - Отсутствие шифрования чувствительных данных
   - Широкий доступ к данным клиентов

4. **Открытый RDP**
   - RDP доступен из интернета
   - Слабые пароли
   - Отсутствие защиты от брутфорса

#### Сценарий обучения
1. **Обнаружение**
   - Анализ версии CRM
   - Тестирование доступа к системе
   - Обнаружение уязвимостей
   - Обнаружение открытого RDP

2. **Эксплуатация**
   - Доступ к CRM с слабыми паролями
   - Извлечение данных клиентов
   - Модификация записей клиентов
   - Доступ через RDP

3. **Устранение**
   - Обновление CRM
   - Изменение паролей администраторов
   - Шифрование данных клиентов
   - Ограничение доступа RDP

---

#### Описание
CRM система для управления отношениями с клиентами.

#### Конфигурация
- **ОС**: Ubuntu 20.04 LTS
- **CRM**: Проприетарная система на PHP
- **База данных**: MySQL 5.7
- **Порты**: 80, 443

#### Уязвимости
1. **Уязвимая версия CRM**
   - Устаревшая версия с известными уязвимостями
   - Непатченные компоненты
   - Отсутствие обновлений безопасности

2. **Слабые пароли администраторов**
   - Простые пароли для учетных записей администраторов
   - Пароли по умолчанию
   - Отсутствие двухфакторной аутентификации

3. **Утечка данных клиентов**
   - Персональные данные в открытом виде
   - Отсутствие шифрования чувствительных данных
   - Широкий доступ к данным клиентов

#### Сценарий обучения
1. **Обнаружение**
   - Анализ версии CRM
   - Тестирование доступа к системе
   - Обнаружение уязвимостей

2. **Эксплуатация**
   - Доступ к CRM с слабыми паролями
   - Извлечение данных клиентов
   - Модификация записей клиентов

3. **Устранение**
   - Обновление CRM
   - Изменение паролей администраторов
   - Шифрование данных клиентов

---

## Управляющие серверы

### 11. Monitoring Server (192.168.30.10)

#### Описание
Сервер мониторинга сетевого оборудования и серверов.

#### Конфигурация
- **ОС**: Ubuntu 20.04 LTS
- **Мониторинг**: Zabbix 5.4
- **SNMP**: Установлен
- **Порты**: 80, 443, 10051, 161

#### Уязвимости
1. **Слабые SNMP community strings**
   - Публичный community string: `public`
   - Приватный community string: `private`
   - Отсутствие шифрования SNMP трафика

2. **Открытый веб-интерфейс**
   - Zabbix доступен без аутентификации
   - Слабые пароли администраторов
   - Раскрытие информации о инфраструктуре

3. **Раскрытие информации**
   - Метрики содержат чувствительную информацию
   - Логи доступны без ограничений
   - Информация о сетевом оборудовании

#### Сценарий обучения
1. **Обнаружение**
   - Обнаружение SNMP на оборудовании
   - Доступ к веб-интерфейсу Zabbix
   - Анализ метрик и логов

2. **Эксплуатация**
   - Использование SNMP для получения информации
   - Извлечение информации из Zabbix
   - Использование информации для дальнейших атак

3. **Устранение**
   - Изменение SNMP community strings
   - Включение аутентификации в Zabbix
   - Ограничение доступа

---

### 12. Jump Server (192.168.30.20)

#### Описание
Jump-сервер для безопасного доступа администраторов к инфраструктуре.

#### Конфигурация
- **ОС**: Ubuntu 20.04 LTS
- **SSH**: OpenSSH 8.2
- **VPN**: OpenVPN установлен
- **Порты**: 22, 1194

#### Уязвимости
1. **Доступ по паролю**
   - SSH доступ по паролю разрешен
   - Отсутствие аутентификации по ключам
   - Слабые пароли пользователей

2. **Отсутствие 2FA**
   - Двухфакторная аутентификация не настроена
   - Только парольная аутентификация
   - Отсутствие защиты от брутфорса

3. **Широкий доступ**
   - Доступ к jump-серверу без ограничений
   - Отсутствие аудита сессий
   - Нет ограничений по времени доступа

#### Сценарий обучения
1. **Обнаружение**
   - Поиск jump-сервера
   - Тестирование SSH доступа
   - Брутфорс паролей

2. **Эксплуатация**
   - Доступ к jump-серверу
   - Использование как плацдарма для дальнейших атак
   - Компрометация всей инфраструктуры

3. **Устранение**
   - Включение аутентификации по ключам
   - Настройка 2FA
   - Ограничение доступа и аудит

---

### 13. Backup Server (192.168.30.30)

#### Описание
Сервер резервного копирования для хранения бэкапов всех систем.

#### Конфигурация
- **ОС**: Ubuntu 20.04 LTS
- **Rsync**: Последняя версия
- **BackupPC**: Установлен
- **Порты**: 22, 873

#### Уязвимости
1. **SSH доступ по паролю**
   - Отключена аутентификация по ключам
   - Слабые пароли
   - Отсутствие защиты от брутфорса

2. **Нешифрованные бэкапы**
   - Бэкапы хранятся без шифрования
   - Доступны в открытом виде
   - Содержат чувствительные данные

3. **Отсутствие контроля доступа**
   - Широкий доступ к бэкапам
   - Отсутствие аудита доступа
   - Нет разграничения прав доступа

#### Сценарий обучения
1. **Обнаружение**
   - Поиск сервера резервного копирования
   - Тестирование SSH доступа
   - Перечисление бэкапов

2. **Эксплуатация**
   - Доступ к бэкапам через SSH
   - Извлечение данных из бэкапов
   - Компрометация других систем через бэкапы

3. **Устранение**
   - Включение аутентификации по ключам
   - Шифрование бэкапов
   - Ограничение доступа

---

## Рабочие станции Windows 10

### 14. Рабочие станции сотрудников (192.168.40.10-192.168.40.30)

#### Описание
Рабочие станции сотрудников компании на базе Windows 10.

#### Конфигурация
- **ОС**: Windows 10 Home/Pro (разные версии, необновленные)
- **Количество**: 20 рабочих станций
- **Домен**: internetplus.local (присоединены к домену)
- **Порты**: 135, 139, 445 (SMB), 3389 (RDP), 5985 (WinRM)

#### Общие уязвимости для всех рабочих станций
1. **Необновленное ПО**
   - Устаревшие версии Windows 10 без обновлений безопасности
   - Отключенный Windows Update
   - Уязвимые версии браузеров и приложений
   - Отсутствие обновлений .NET Framework

2. **Слабые пароли**
   - Простые пароли пользователей
   - Пароли по умолчанию
   - Отсутствие политики сложности паролей
   - Пароли хранятся в открытом виде

3. **Открытые сетевые порты**
   - SMB порты открыты (139, 445)
   - RDP доступен в локальной сети
   - WinRM доступен без ограничений
   - Отсутствие брандмауэра или неправильная конфигурация

4. **Отсутствие защиты**
   - Антивирус не установлен или отключен
   - Windows Defender отключен
   - Отсутствие защиты от вредоносного ПО
   - Отключен UAC (User Account Control)

5. **Учетные данные в открытом виде**
   - Пароли в текстовых файлах
   - Учетные данные в браузерах
   - SSH ключи с слабыми паролями
   - Конфигурационные файлы с паролями

#### Специфичные уязвимости по ролям

##### Рабочие станции администраторов (ws-admin1, ws-admin2, ws-admin3)
- Локальные права администратора
- Учетные данные для серверов в открытом виде
- SSH ключи для доступа к Linux серверам
- Пароли в файлах конфигурации

##### Рабочие станции менеджеров (ws-sales1, ws-sales2, ws-sales3)
- Учетные данные CRM в браузере
- Пароли в текстовых файлах
- Доступ к данным других менеджеров

##### Рабочие станции бухгалтерии (ws-accountant, ws-accountant2)
- Финансовые данные в открытом виде
- Учетные данные биллинга в файлах
- Пароли баз данных в конфигурационных файлах

#### Сценарий обучения
1. **Обнаружение**
   - Сканирование сети для обнаружения Windows машин
   - Обнаружение открытых портов (SMB, RDP, WinRM)
   - Перечисление пользователей через SMB
   - Обнаружение необновленных систем

2. **Эксплуатация**
   - Эксплуатация EternalBlue (SMBv1) для получения доступа
   - Брутфорс паролей через RDP
   - Pass-the-Hash атаки
   - Извлечение учетных данных из файлов
   - Использование учетных данных для доступа к серверам

3. **Пост-эксплуатация**
   - Сбор информации о домене
   - Извлечение учетных данных из браузеров
   - Поиск чувствительных данных в файлах
   - Использование для дальнейших атак на серверы

4. **Устранение**
   - Включение Windows Update
   - Установка обновлений безопасности
   - Установка и настройка антивируса
   - Ограничение прав локальных администраторов
   - Удаление учетных данных из открытых файлов
   - Настройка брандмауэра
   - Отключение SMBv1

---

## Комплексные сценарии

### Сценарий A: Компрометация через RADIUS сервер
1. Эксплуатация слабого пароля MySQL на RADIUS сервере
2. Извлечение учетных данных клиентов
3. Использование учетных данных для доступа к клиентскому порталу
4. Модификация данных клиентов в биллинге
5. Использование данных для дальнейших атак

### Сценарий B: Утечка данных через биллинговую систему
1. Эксплуатация SQL инъекции в биллинге
2. Извлечение персональных данных клиентов
3. Извлечение платежной информации
4. Использование данных для фишинга
5. Обнаружение и расследование инцидента

### Сценарий C: Атака через веб-портал
1. Эксплуатация уязвимостей WordPress
2. Получение доступа к веб-серверу
3. Перемещение к базе данных
4. Извлечение данных клиентов
5. Компрометация других систем

### Сценарий D: Компрометация через Active Directory
1. Обнаружение Domain Controller через LDAP
2. Эксплуатация EternalBlue (SMBv1) для получения доступа
3. Извлечение хешей паролей через DCSync
4. Pass-the-Hash атаки на другие системы
5. Компрометация всей инфраструктуры через учетные данные домена

### Сценарий E: Атака через рабочие станции Windows 10
1. Обнаружение рабочих станций через SMB
2. Эксплуатация EternalBlue или брутфорс RDP
3. Извлечение учетных данных из файлов и браузеров
4. Использование учетных данных для доступа к серверам
5. Компрометация критичных систем (биллинг, CRM, AD)

### Сценарий F: Комплексная атака - от рабочей станции к критичным системам
1. Компрометация рабочей станции администратора
2. Извлечение учетных данных для серверов
3. Доступ к Domain Controller через RDP
4. Извлечение хешей паролей через DCSync
5. Компрометация всех систем в домене
6. Извлечение данных клиентов из биллинга и CRM

## Методические рекомендации

### Для начинающих
- Начните с простых сценариев (слабые пароли, SQL инъекции)
- Используйте готовые инструменты для сканирования
- Фокусируйтесь на обнаружении уязвимостей в веб-приложениях

### Для среднего уровня
- Комбинируйте несколько уязвимостей
- Используйте цепочки атак через разные системы
- Фокусируйтесь на эксплуатации и пост-эксплуатации

### Для продвинутых
- Проводите комплексные пентесты всей инфраструктуры
- Используйте сетевые атаки (DNS, NTP)
- Эксплуатируйте уязвимости Active Directory (EternalBlue, DCSync, Pass-the-Hash)
- Фокусируйтесь на обнаружении и реагировании на инциденты
- Анализируйте логи и метрики для обнаружения атак
- Используйте цепочки атак через Windows и Linux системы


