# –°—Ü–µ–Ω–∞—Ä–∏–∏ –º–∞—à–∏–Ω –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∑–∞—â–∏—Ç–µ –û–°

## ‚ö†Ô∏è –í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–í—Å–µ —Ç—Ä–∏ –º–∞—à–∏–Ω—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏ 192.168.100.0/24 –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å –∑–∞–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—è–º–∏ –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è.**

### –°–µ—Ç–µ–≤–∞—è —Ç–æ–ø–æ–ª–æ–≥–∏—è

```
–£—á–µ–±–Ω–∞—è —Å–µ—Ç—å: 192.168.100.0/24
‚îú‚îÄ‚îÄ Ubuntu Server:      192.168.100.10  (Linux —É—è–∑–≤–∏–º–æ—Å—Ç–∏)
‚îú‚îÄ‚îÄ Windows Server 2016: 192.168.100.20 (Windows Server —É—è–∑–≤–∏–º–æ—Å—Ç–∏)
‚îî‚îÄ‚îÄ Windows 10 Pro:     192.168.100.30  (–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏)
```

–í—Å–µ –º–∞—à–∏–Ω—ã –º–æ–≥—É—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º –≤ —Ä–∞–º–∫–∞—Ö —ç—Ç–æ–π —Å–µ—Ç–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –ü—Ä–æ–≤–æ–¥–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∞—Ç–∞–∫–∏ –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏
- –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ (SMB, RDP, SSH)
- –û–±—É—á–∞—Ç—å –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–º —Ç–µ—Ö–Ω–∏–∫–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–µ–∂—Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

---

## Ubuntu Server (192.168.100.10)

### –û–ø–∏—Å–∞–Ω–∏–µ
Ubuntu Server 20.04 LTS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å —Ç–∏–ø–∏—á–Ω—ã–º–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—è–º–∏ –û–° Linux, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –¥–æ–ø—É—Å–∫–∞—é—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã. –í—Å–µ–≥–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ 12 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –æ—à–∏–±–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ú–∞—à–∏–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏ —Å Windows Server 2016 –∏ Windows 10 Pro, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –º–µ–∂—Å–∏—Å—Ç–µ–º–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏ —Å–µ—Ç–µ–≤—ã–µ –∞—Ç–∞–∫–∏ –º–µ–∂–¥—É Linux –∏ Windows —Å–∏—Å—Ç–µ–º–∞–º–∏.

---

## üõ° 1. –û–®–ò–ë–ö–ò –í –£–ü–†–ê–í–õ–ï–ù–ò–ò –ê–ö–ö–ê–£–ù–¢–ê–ú–ò –ò –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ï–ô

### 1.1. –ü–∞—Ä–æ–ª–∏ –∏ –ø–æ–ª–∏—Ç–∏–∫–∞ —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π

#### –†–∞–∑—Ä–µ—à–µ–Ω—ã —Å–ª–∞–±—ã–µ –ø–∞—Ä–æ–ª–∏, –Ω–µ—Ç PAM-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `admin` —Å –ø–∞—Ä–æ–ª–µ–º `admin123`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `user1` —Å –ø–∞—Ä–æ–ª–µ–º `password123`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `user2` —Å –ø–∞—Ä–æ–ª–µ–º `123456`
- –ü–∞—Ä–æ–ª—å root: `root123`

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
cat /etc/passwd
# –ü—Ä–æ–≤–µ—Ä–∫–∞ PAM –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cat /etc/security/pwquality.conf
# –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ —Å —Å–ª–∞–±—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏
ssh admin@192.168.100.10
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PAM-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
sudo nano /etc/security/pwquality.conf
# minlen = 12
# dcredit = -1
# ucredit = -1
# lcredit = -1
# ocredit = -1
# minclass = 3

# –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –Ω–∞ —Å–ª–æ–∂–Ω—ã–µ
sudo passwd admin
```

#### –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–ª–∏—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ—Å–ª–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–µ–≤–µ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
- –ù–µ—Ç pam_tally2 –∏–ª–∏ fail2ban –¥–ª—è SSH
- –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ PAM –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
grep pam_tally2 /etc/pam.d/common-auth
# –ü—Ä–æ–≤–µ—Ä–∫–∞ fail2ban
systemctl status fail2ban
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ fail2ban
sudo apt install fail2ban
sudo systemctl enable fail2ban
sudo systemctl start fail2ban
```

#### –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å—Ä–æ–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª–µ–π
- –í—Å–µ –ø–∞—Ä–æ–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –±–µ–∑ —Å—Ä–æ–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è (`chage -M -1`)

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–æ–≤ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª–µ–π
chage -l admin
chage -l user1
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª–µ–π (90 –¥–Ω–µ–π)
sudo chage -M 90 admin
sudo chage -M 90 user1
sudo chage -M 90 user2
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –¥–ª—è –≤—Å–µ—Ö –∑–∞–¥–∞—á
- –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç –ø–æ–ª–Ω—ã–µ sudo –ø—Ä–∞–≤–∞ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- NOPASSWD –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ sudo –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo cat /etc/sudoers.d/vulnerable
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª
sudo rm /etc/sudoers.d/vulnerable
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö sudo –ø—Ä–∞–≤
sudo visudo -f /etc/sudoers.d/secure
```

#### –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è MFA
- –ù–µ—Ç –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è SSH
- –ù–µ—Ç –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π (FIDO2/YubiKey)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Google Authenticator PAM –º–æ–¥—É–ª—è
sudo apt install libpam-google-authenticator
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
google-authenticator
```

---

## üõ° 2. –£–Ø–ó–í–ò–ú–û–°–¢–ò –ü–†–ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò SSH

### 2.1. –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã SSH

#### –†–∞–∑—Ä–µ—à—ë–Ω –ø–∞—Ä–æ–ª—å–Ω—ã–π –≤—Ö–æ–¥ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- `PasswordAuthentication yes`
- `MaxAuthTries 1000` (–Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏)

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ SSH
grep -E "PasswordAuthentication|MaxAuthTries" /etc/ssh/sshd_config
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
sudo sed -i 's/PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config
sudo sed -i 's/MaxAuthTries 1000/MaxAuthTries 3/' /etc/ssh/sshd_config
sudo systemctl restart ssh
```

#### –°–ª–∞–±—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (–Ω–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π sshd_config)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤: `diffie-hellman-group1-sha1`, `aes128-cbc`, `hmac-md5`

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
grep -E "KexAlgorithms|Ciphers|MACs" /etc/ssh/sshd_config
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
sudo nano /etc/ssh/sshd_config
# KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256
# Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com
# MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com
sudo systemctl restart ssh
```

#### –ü–æ—Ä—Ç SSH –æ—Ç–∫—Ä—ã—Ç –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –±–µ–∑ –∑–∞—â–∏—Ç—ã (fail2ban, firewall)
- SSH –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- fail2ban –æ—Ç–∫–ª—é—á–µ–Ω
- UFW –æ—Ç–∫–ª—é—á–µ–Ω

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ fail2ban
systemctl status fail2ban
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ UFW
ufw status
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –í–∫–ª—é—á–µ–Ω–∏–µ fail2ban
sudo systemctl enable fail2ban
sudo systemctl start fail2ban

# –í–∫–ª—é—á–µ–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ UFW
sudo ufw enable
sudo ufw default deny incoming
sudo ufw allow 22/tcp from 192.168.100.0/24
```

### 2.2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–ª—é—á–µ–π

#### –°—Ç–∞—Ä—ã–µ –∏–ª–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SSH-–∫–ª—é—á–∏ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –°—Ç–∞—Ä—ã–µ –∫–ª—é—á–∏ –≤ `/home/admin/.ssh/authorized_keys`

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ authorized_keys
cat ~/.ssh/authorized_keys
ls -la ~/.ssh/
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∫–ª—é—á–µ–π
nano ~/.ssh/authorized_keys
# –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–ª—é—á–∏
```

#### –ù–µ–¥–æ–æ—Ü–µ–Ω–∫–∞ authorized_keys —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- –§–∞–π–ª `authorized_keys` —Å –ø—Ä–∞–≤–∞–º–∏ 644 (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 600)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–∞–≤
chmod 600 ~/.ssh/authorized_keys
chmod 700 ~/.ssh
```

---

## üõ° 3. –û–®–ò–ë–ö–ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò –°–ï–¢–ò –ò FIREWALL

### 3.1. Firewall Off
- UFW –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–µ–Ω
- iptables –ø—Ä–∞–≤–∏–ª–∞ —Å–±—Ä–æ—à–µ–Ω—ã
- –í—Å–µ –ø–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ UFW
ufw status
# –ü—Ä–æ–≤–µ—Ä–∫–∞ iptables
sudo iptables -L
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –í–∫–ª—é—á–µ–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ UFW
sudo ufw enable
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
```

### 3.2. –ù–µ–≤–µ—Ä–Ω–∞—è —Å–µ—Ç—å/–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
- –°–µ—Ä–≤–µ—Ä –≤–∏–¥–µ–Ω –≤–æ –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–∞—Ö
- –ù–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ –∑–æ–Ω—ã

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∑–æ–Ω —á–µ—Ä–µ–∑ firewalld –∏–ª–∏ UFW
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –ø–æ IP
sudo ufw allow from 192.168.100.0/24 to any port 22
```

### 3.3. –û—Ç–∫—Ä—ã—Ç—ã–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–æ—Ä—Ç—ã
- Telnet (–ø–æ—Ä—Ç 23)
- FTP (–ø–æ—Ä—Ç 21)
- Rlogin (–ø–æ—Ä—Ç 513)
- RPC, Samba, NFS –±–µ–∑ –∑–∞—â–∏—Ç—ã

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤
sudo nmap -sS localhost
sudo netstat -tulpn
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl stop telnet
sudo systemctl disable telnet
sudo systemctl stop vsftpd
sudo systemctl disable vsftpd
sudo systemctl stop rsh
sudo systemctl disable rsh
```

---

## üõ° 4. –û–®–ò–ë–ö–ò –ü–†–ò –ù–ê–°–¢–†–û–ô–ö–ï –û–ë–ù–û–í–õ–ï–ù–ò–ô –ò –ü–ê–ö–ï–¢–û–í

### 4.1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω—ã
- –§–∞–π–ª `/etc/apt/apt.conf.d/20auto-upgrades` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
cat /etc/apt/apt.conf.d/20auto-upgrades
apt list --upgradable
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –í–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
sudo apt install unattended-upgrades
sudo dpkg-reconfigure -plow unattended-upgrades
```

### 4.2. –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ PPA –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–≤–µ—Ä–∏—è
- –ü–∞–∫–µ—Ç—ã –∏–∑ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
cat /etc/apt/sources.list
ls /etc/apt/sources.list.d/
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
sudo rm /etc/apt/sources.list.d/untrusted-*.list
sudo apt update
```

### 4.3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π –ø–∞–∫–µ—Ç–æ–≤ –æ—Ç–∫–ª—é—á–µ–Ω–∞
- `APT::Get::AllowUnauthenticated "true"`

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cat /etc/apt/apt.conf.d/99unauthenticated
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo rm /etc/apt/apt.conf.d/99unauthenticated
```

---

## üõ° 5. –û–®–ò–ë–ö–ò –í –£–ü–†–ê–í–õ–ï–ù–ò–ò –°–õ–£–ñ–ë–ê–ú–ò –ò –î–ï–ú–û–ù–ê–ú–ò

### 5.1. –õ–∏—à–Ω–∏–µ —Å–ª—É–∂–±—ã –≤–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- CUPS (–ø–µ—á–∞—Ç—å)
- Avahi (mDNS)
- Bluetooth
- NFS —Å–µ—Ä–≤–µ—Ä

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö —Å–ª—É–∂–±
systemctl list-units --type=service --state=running
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Å–ª—É–∂–±
sudo systemctl stop cups
sudo systemctl disable cups
sudo systemctl stop avahi-daemon
sudo systemctl disable avahi-daemon
sudo systemctl stop bluetooth
sudo systemctl disable bluetooth
```

### 5.2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
- –°–ª—É–∂–±—ã —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç root –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ù–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
- AppArmor –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–ª—É–∂–±
ps aux | grep apache2
systemctl status apparmor
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –í–∫–ª—é—á–µ–Ω–∏–µ AppArmor
sudo systemctl enable apparmor
sudo systemctl start apparmor
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π –¥–ª—è —Å–ª—É–∂–±
sudo aa-enforce /etc/apparmor.d/*
```

---

## üõ° 6. –û–®–ò–ë–ö–ò –° –ü–†–ê–í–ê–ú–ò –î–û–°–¢–£–ü–ê –ò –§–ê–ô–õ–ê–ú–ò

### 6.1. –ù–µ–≤–µ—Ä–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- `/etc` —Å –ø—Ä–∞–≤–∞–º–∏ 777
- `/var` —Å –ø—Ä–∞–≤–∞–º–∏ 777
- `/home` —Å –ø—Ä–∞–≤–∞–º–∏ 777
- `/var/log` —Å –ø—Ä–∞–≤–∞–º–∏ 777
- `/usr/local/bin` —Å –ø—Ä–∞–≤–∞–º–∏ 777

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
ls -la /etc
ls -la /var
ls -la /home
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–∞–≤
sudo chmod 755 /etc
sudo chmod 755 /var
sudo chmod 755 /home
sudo chmod 755 /var/log
sudo chmod 755 /usr/local/bin
```

### 6.2. –ß—Ä–µ–∑–º–µ—Ä–Ω–æ —à–∏—Ä–æ–∫–∏–µ sudo/grant –ø—Ä–∞–≤–∞
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å `sudo su`
- Sudoers —Å–æ–¥–µ—Ä–∂–∏—Ç wildcard-–∫–æ–º–∞–Ω–¥—ã
- NOPASSWD –¥–ª—è –≤—Å–µ—Ö

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª
sudo rm /etc/sudoers.d/vulnerable
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –ø—Ä–∞–≤
sudo visudo
```

### 6.3. –ù–µ–Ω–∞–¥—ë–∂–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∏ Cron
- Cron –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç root –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—É—Ç–µ–π
- –°–∫—Ä–∏–ø—Ç—ã –≤ `/etc/cron.d` –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –°–∫—Ä–∏–ø—Ç—ã –≤ `/usr/local/bin` —Å –ø—Ä–∞–≤–∞–º–∏ 777

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ cron –∑–∞–¥–∞—á
cat /etc/cron.d/vulnerable
ls -la /usr/local/bin/
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö cron –∑–∞–¥–∞—á
sudo rm /etc/cron.d/vulnerable
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–∞–≤ –Ω–∞ —Å–∫—Ä–∏–ø—Ç—ã
sudo chmod 755 /usr/local/bin/unsafe_script.sh
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π –≤ cron
```

### 6.4. –£—è–∑–≤–∏–º–æ—Å—Ç–∏ /etc/shadow –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è–º–∏

#### 6.4.1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ /etc/shadow

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–û–ø–∏—Å–∞–Ω–∏–µ**: –§–∞–π–ª `/etc/shadow` –∏–º–µ–µ—Ç —Å–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —á–∏—Ç–∞—Ç—å —Ö–µ—à–∏ –ø–∞—Ä–æ–ª–µ–π.

**–°—Ç–∞–Ω–¥–∞—Ä—Ç**:
```
-r-------- 1 root shadow /etc/shadow
```

**–û—à–∏–±–∫–∏**:
- –§–∞–π–ª –¥–æ—Å—Ç—É–ø–µ–Ω —á—Ç–µ–Ω–∏—é –Ω–µ —Ç–æ–ª—å–∫–æ root (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0644, 0660)
- –ì—Ä—É–ø–ø–∞ shadow —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏—à–Ω–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –º–æ–≥—É—Ç –∫–æ—Å–≤–µ–Ω–Ω–æ —á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ /etc/shadow
ls -la /etc/shadow
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: -r-------- 1 root shadow

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ –≥—Ä—É–ø–ø–µ shadow
getent group shadow
# –ü—Ä–æ–≤–µ—Ä–∫–∞, –∫—Ç–æ –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–∞–≤
sudo chmod 640 /etc/shadow
sudo chown root:shadow /etc/shadow

# –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –≥—Ä—É–ø–ø—ã shadow
sudo deluser admin shadow
sudo deluser user1 shadow
```

**–†–∏—Å–∫**: –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ö–µ—à–∞–º –ø–∞—Ä–æ–ª–µ–π, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ñ—Ñ–ª–∞–π–Ω-–∞—Ç–∞–∫–∏ –ø–µ—Ä–µ–±–æ—Ä–∞.

---

#### 6.4.2. –£—Ç–µ—á–∫–∏ /etc/shadow —á–µ—Ä–µ–∑ –Ω–µ–≤–µ—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–æ–ø–∏–∏ `/etc/shadow` —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–∞—Ö –∏–ª–∏ –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.

**–°–∏—Ç—É–∞—Ü–∏–∏**:
- –ö–æ–ø–∏–∏ `/etc/shadow` —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –≤ `/tmp`, `/home`, –∏–ª–∏ –≤ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–∞—Ö
- –°–∫—Ä–∏–ø—Ç—ã –∏–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–µ–ª–∞—é—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ chmod
- –ë—ç–∫–∞–ø—ã –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –æ–±–ª–∞–∫–æ –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü–æ–∏—Å–∫ –∫–æ–ø–∏–π /etc/shadow
find / -name "*shadow*" -type f 2>/dev/null
find /tmp -name "*shadow*" 2>/dev/null
find /home -name "*shadow*" 2>/dev/null
find /var/www -name "*shadow*" 2>/dev/null

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
ls -la /tmp/shadow_backup
ls -la /home/admin/shadow_backup.txt
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∫–æ–ø–∏–π
sudo rm /tmp/shadow_backup
sudo rm /home/admin/shadow_backup.txt
sudo rm /var/www/html/shadow_backup.txt

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±—ç–∫–∞–ø–æ–≤
sudo tar -czf - /etc/shadow | gpg --encrypt --recipient admin@example.com > shadow_backup.tar.gz.gpg
```

**–†–∏—Å–∫**: –£—Ç–µ—á–∫–∞ —Ö–µ—à–µ–π –±–µ–∑ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞.

---

#### 6.4.3. –û—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ PAM

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–û–ø–∏—Å–∞–Ω–∏–µ**: PAM –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø—É—Å—Ç—ã–º–∏ –∏–ª–∏ —Å–ª–∞–±—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏.

**–ü—Ä–æ–±–ª–µ–º—ã**:
- `pam_unix` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ü—Ä–æ–ø—É—â–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- –†–∞–∑—Ä–µ—à—ë–Ω –ø—É—Å—Ç–æ–π –ø–∞—Ä–æ–ª—å (`nullok`)

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ PAM
grep nullok /etc/pam.d/common-password
grep pam_pwquality /etc/pam.d/common-password

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—É—Å—Ç—ã–º –ø–∞—Ä–æ–ª–µ–º
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ nullok –∏–∑ PAM –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo sed -i 's/nullok//g' /etc/pam.d/common-password

# –í–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª–µ–π
sudo nano /etc/pam.d/common-password
# –î–æ–±–∞–≤–∏—Ç—å: password        requisite                       pam_pwquality.so retry=3
```

**–û—à–∏–±–∫–∏ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ PAM-–∫–æ–Ω—Ñ–∏–≥–æ–≤**:
- –£–¥–∞–ª–µ–Ω–∏–µ –∏–ª–∏ –ø–µ—Ä–µ–ø—É—Ç–∞–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—Ö–æ–¥–∞ –±–µ–∑ –ø–∞—Ä–æ–ª—è
- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—é –ø–æ–ª–∏—Ç–∏–∫–∏ aging

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ PAM
sudo pam-auth-update
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```

**–†–∏—Å–∫**: –ü–æ—è–≤–ª–µ–Ω–∏–µ —Å–ª–∞–±—ã—Ö –∏–ª–∏ –ø—É—Å—Ç—ã—Ö –ø–∞—Ä–æ–ª–µ–π –≤ `/etc/shadow`.

---

#### 6.4.4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º—ã—Ö –∏–ª–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–∞–±—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ª–µ–≥–∫–æ –ø–æ–¥–æ–±—Ä–∞—Ç—å –≤ –æ—Ñ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ.

**–°—Ç—Ä–æ–∫–∏ –≤ /etc/shadow**:
```
username:$id$salt$hash:...
```

**–û—à–∏–±–∫–∏**:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MD5 (`$1$`)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SHA-256 (`$5$`) –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É—Å–∏–ª–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SHA-512 (`$6$`) —Å –Ω–∏–∑–∫–∏–º rounds
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PAM –Ω–∞ –±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ /etc/shadow
sudo grep -E '^\w+:\$[156]\$' /etc/shadow

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ rounds –¥–ª—è SHA-512
sudo grep -E '^\w+:\$6\$rounds=' /etc/shadow
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: rounds=5000 –∏–ª–∏ –≤—ã—à–µ
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PAM –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SHA-512 —Å –≤—ã—Å–æ–∫–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º rounds
sudo nano /etc/pam.d/common-password
# –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞: password        [success=1 default=ignore]      pam_unix.so obscure sha512 rounds=5000

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª–µ–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —É—è–∑–≤–∏–º—ã–º–∏ —Ö–µ—à–∞–º–∏
sudo chage -d 0 username
```

**–†–∏—Å–∫**: –•–µ—à–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ –ª–µ–≥–∫–æ –ø–æ–¥–æ–±—Ä–∞–Ω—ã –≤ –æ—Ñ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ.

---

#### 6.4.5. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–æ–ª—å–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏ (shadow aging fields)

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üü° –í–´–°–û–ö–ê–Ø

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–µ–π —Å—Ç–∞—Ä–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π –≤ `/etc/shadow`.

**–í shadow —Ö—Ä–∞–Ω—è—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –ø–∞—Ä–æ–ª—è
- –í—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ–Ω—ã

**–û—à–∏–±–∫–∏**:
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å—Ç–µ–∫–∞—é—â–∏–µ –ø–∞—Ä–æ–ª–∏ (99999)
- –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Å—Ä–æ–∫–∏ —Å–º–µ–Ω—ã
- –ù–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∞–∫–∫–∞—É–Ω—Ç—ã

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ shadow aging
sudo chage -l admin
sudo chage -l user1

# –ü—Ä–æ–≤–µ—Ä–∫–∞ /etc/shadow –Ω–∞–ø—Ä—è–º—É—é
sudo awk -F: '{print $1, $5}' /etc/shadow
# –ü—è—Ç–æ–µ –ø–æ–ª–µ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª—è (99999 = –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å—Ç–µ–∫–∞–µ—Ç)
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª–µ–π (90 –¥–Ω–µ–π)
sudo chage -M 90 admin
sudo chage -M 90 user1
sudo chage -M 90 user2

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Å—Ä–æ–∫–∞ –º–µ–∂–¥—É —Å–º–µ–Ω–∞–º–∏ –ø–∞—Ä–æ–ª–µ–π (7 –¥–Ω–µ–π)
sudo chage -m 7 admin
sudo chage -m 7 user1

# –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
sudo chage -E 0 olduser
```

**–†–∏—Å–∫**: –ü–∞—Ä–æ–ª–∏ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è –≥–æ–¥–∞–º–∏ ‚Üí –ø–æ–≤—ã—à–∞–µ—Ç—Å—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏.

---

#### 6.4.6. –î–æ—Å—Ç—É–ø –∫ /etc/shadow —á–µ—Ä–µ–∑ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ SUID-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–º–µ—é—Ç SUID root –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è —á—Ç–µ–Ω–∏—è `/etc/shadow`.

**–ü—Ä–æ–±–ª–µ–º—ã**:
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ SUID –ø—Ä–æ–≥—Ä–∞–º–º—ã, –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ —á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª—ã –æ—Ç root
- –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∏–ª–∏ —É—è–∑–≤–∏–º—ã–µ –≤–µ—Ä—Å–∏–∏ —É—Ç–∏–ª–∏—Ç (`passwd`, `chage`, `su`)

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü–æ–∏—Å–∫ SUID –ø—Ä–æ–≥—Ä–∞–º–º
find /usr -perm -4000 -type f 2>/dev/null
find /usr/local -perm -4000 -type f 2>/dev/null

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º—ã—Ö SUID —Å–∫—Ä–∏–ø—Ç–æ–≤
ls -la /usr/local/bin/read_shadow
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ —É—è–∑–≤–∏–º—ã—Ö SUID —Å–∫—Ä–∏–ø—Ç–æ–≤
sudo rm /usr/local/bin/read_shadow

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Ç–∏–ª–∏—Ç
sudo apt update
sudo apt upgrade passwd chage

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ SUID –ø—Ä–æ–≥—Ä–∞–º–º
sudo find /usr -perm -4000 -type f -exec chmod u-s {} \;
```

**–†–∏—Å–∫**: –û–±—Ö–æ–¥ –ø—Ä—è–º–æ–≥–æ –∑–∞–ø—Ä–µ—Ç–∞ —á—Ç–µ–Ω–∏—è `/etc/shadow` —á–µ—Ä–µ–∑ —Ü–µ–ø–æ—á–∫—É —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.

---

#### 6.4.7. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–û–ø–∏—Å–∞–Ω–∏–µ**: –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ `/etc/shadow` —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏.

**–û—à–∏–±–∫–∏**:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å root —á–µ—Ä–µ–∑ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ sudoers –∏–ª–∏ misconfigured services
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –≤ single-user mode
- –ù–µ—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–∞ ‚Üí —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø = –¥–æ—Å—Ç—É–ø –∫ shadow

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ sudo –ø—Ä–∞–≤
sudo -l

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–∞
lsblk
sudo cryptsetup status /dev/sda1

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã GRUB
sudo cat /etc/default/grub | grep GRUB_CMDLINE_LINUX
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ sudo –ø—Ä–∞–≤
sudo visudo
# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª

# –ó–∞—â–∏—Ç–∞ GRUB –ø–∞—Ä–æ–ª–µ–º
sudo nano /etc/default/grub
# –î–æ–±–∞–≤–∏—Ç—å: GRUB_CMDLINE_LINUX=""
sudo grub-mkpasswd-pbkdf2
sudo nano /etc/grub.d/40_custom
# –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è GRUB
sudo update-grub

# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∏)
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ LUKS –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
```

**–†–∏—Å–∫**: –§–∏–∑–∏—á–µ—Å–∫–∏–π –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–ø–∏—é —Ñ–∞–π–ª–∞.

---

#### 6.4.8. –£—Ç–µ—á–∫–∞ shadow —á–µ—Ä–µ–∑ web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ CGI

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å `/etc/shadow` —á–µ—Ä–µ–∑ directory traversal –∏–ª–∏ –¥—Ä—É–≥–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏.

**–û—à–∏–±–∫–∏**:
- –ù–µ–≤–µ—Ä–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (directory traversal, misconfigured alias)
- –°–∫—Ä–∏–ø—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç –∏–ª–∏ —á–∏—Ç–∞—é—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã
- –°–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ CMS/—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Apache
cat /etc/apache2/sites-available/shadow-leak.conf
grep -r "Alias.*etc" /etc/apache2/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ /etc —á–µ—Ä–µ–∑ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
curl http://localhost/etc/shadow

# –ü–æ–∏—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤, —á–∏—Ç–∞—é—â–∏—Ö —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã
grep -r "cat /etc/shadow" /var/www/
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∞–ª–∏–∞—Å–æ–≤
sudo rm /etc/apache2/sites-enabled/shadow-leak.conf
sudo a2dissite shadow-leak.conf

# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Apache
sudo nano /etc/apache2/sites-available/default
# –£–¥–∞–ª–∏—Ç—å: Alias /etc /etc

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º —Ñ–∞–π–ª–∞–º
sudo systemctl reload apache2
```

**–†–∏—Å–∫**: –£–¥–∞–ª—ë–Ω–Ω—ã–π –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç —Ñ–∞–π–ª –±–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.

---

#### 6.4.9. –°–º–µ—à–∏–≤–∞–Ω–∏–µ system accounts –∏ application accounts

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üü° –í–´–°–û–ö–ê–Ø

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–æ–∑–¥–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º–µ, –∏ –∏—Ö –ø–∞—Ä–æ–ª–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ `/etc/shadow`.

**–û—à–∏–±–∫–∏**:
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–æ–∑–¥–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º–µ, –∏ –∏—Ö –ø–∞—Ä–æ–ª–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ `/etc/shadow`
- –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –ø–æ–ª–∏—Ç–∏–∫

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü–æ–∏—Å–∫ –ø—Ä–∏–∫–ª–∞–¥–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
getent passwd | grep -E "app_|db_|web_|service_"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
find /usr/local/bin -name "*user*" -type f
cat /usr/local/bin/auto_create_users.sh
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏–∫–ª–∞–¥–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Å–∏—Å—Ç–µ–º—ã
sudo deluser app_user
sudo deluser db_user
sudo deluser web_user

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ systemd service accounts –∏–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ (Docker, LXC)

# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
sudo rm /usr/local/bin/auto_create_users.sh
```

**–†–∏—Å–∫**: –£–≤–µ–ª–∏—á–µ–Ω–∏–µ attack surface, —Å–ª–∞–±—ã–µ –ø–∞—Ä–æ–ª–∏ –ø—Ä–∏–∫–ª–∞–¥–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

#### 6.4.10. –û—à–∏–±–∫–∏ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–ª–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–∏—Å—Ç–µ–º

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Ö–µ—à–∞–º –ø–∞—Ä–æ–ª–µ–π –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö.

**–°–∏—Ç—É–∞—Ü–∏–∏**:
- –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ VM –≤–º–µ—Å—Ç–µ —Å `/etc/shadow` ‚Üí –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ö–µ—à–∏ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
- –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ä–µ–¥—ã –∏–º–µ—é—Ç —Ç–µ –∂–µ –ø–∞—Ä–æ–ª–∏, —á—Ç–æ –∏ –ø—Ä–æ–¥

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –æ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
cat /root/CLONING_WARNING.txt

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ö–µ—à–µ–π –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø)
# –•–µ—à–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —Å–µ—Ä–≤–µ—Ä–µ
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–º–µ–Ω–∞ –≤—Å–µ—Ö –ø–∞—Ä–æ–ª–µ–π –ø–æ—Å–ª–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
for user in $(cut -d: -f1 /etc/passwd); do
    if [ "$user" != "root" ]; then
        sudo chage -d 0 $user
    fi
done

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ LAPS (Local Administrator Password Solution) –¥–ª—è Linux
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è–º–∏

# –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
sudo rm /root/CLONING_WARNING.txt
```

**–†–∏—Å–∫**: –û–¥–∏–Ω –≤–∑–ª–æ–º –≤–µ–¥—ë—Ç –∫ —Ü–µ–ø–æ—á–∫–µ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–π.

---

## üõ° 7. –£–Ø–ó–í–ò–ú–û–°–¢–ò –í–ï–ë-–°–ï–†–í–ò–°–û–í –ò –ü–†–ò–õ–û–ñ–ï–ù–ò–ô

### 7.1. –û—à–∏–±–∫–∏ –ø—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Nginx/Apache
- Directory listing –≤–∫–ª—é—á—ë–Ω
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Ö–æ—Å—Ç—ã –∏ logs
- `ServerTokens Full` (—Ä–∞—Å–∫—Ä—ã—Ç–∏–µ –≤–µ—Ä—Å–∏–∏)

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Apache
grep -E "ServerTokens|ServerSignature|Options" /etc/apache2/apache2.conf
ls -la /etc/apache2/sites-available/
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ directory listing
sudo sed -i 's/Options +Indexes/Options -Indexes/' /etc/apache2/apache2.conf
# –°–∫—Ä—ã—Ç–∏–µ –≤–µ—Ä—Å–∏–∏
sudo sed -i 's/ServerTokens Full/ServerTokens Prod/' /etc/apache2/apache2.conf
sudo sed -i 's/ServerSignature On/ServerSignature Off/' /etc/apache2/apache2.conf
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–∞–≤
sudo chmod 644 /etc/apache2/sites-available/*
sudo systemctl restart apache2
```

---

## üõ° 8. –û–®–ò–ë–ö–ò –í –õ–û–ì–ò–†–û–í–ê–ù–ò–ò –ò –ú–û–ù–ò–¢–û–†–ò–ù–ì–ï

### 8.1. –õ–æ–≥–∏ –Ω–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ
- journald –ø–µ—Ä–µ–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏ —Ç–µ—Ä—è–µ—Ç –¥–∞–Ω–Ω—ã–µ
- –ù–µ—Ç —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤
- –ù–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ syslog/SIEM
- rsyslog –æ—Ç–∫–ª—é—á–µ–Ω

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ rsyslog
systemctl status rsyslog
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ journald
cat /etc/systemd/journald.conf
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –í–∫–ª—é—á–µ–Ω–∏–µ rsyslog
sudo systemctl enable rsyslog
sudo systemctl start rsyslog
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤
sudo nano /etc/logrotate.d/rsyslog
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ journald
sudo nano /etc/systemd/journald.conf
# SystemMaxUse=500M
# SystemKeepFree=1G
```

### 8.2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –ù–µ—Ç –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞ –æ—Ç–∫–∞–∑–∞–º–∏ —Å–ª—É–∂–±
- –ù–∏–∫—Ç–æ –Ω–µ —Å–ª–µ–¥–∏—Ç –∑–∞ –ø–æ–ø—ã—Ç–∫–∞–º–∏ –ª–æ–≥–∏–Ω–∞/–≤–∑–ª–æ–º–∞
- –ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –∞–Ω–æ–º–∞–ª–∏–π

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
sudo apt install monit
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–ª—É–∂–±
sudo nano /etc/monit/monitrc
```

---

## üõ° 9. –£–Ø–ó–í–ò–ú–û–°–¢–ò –ö–û–ù–¢–ï–ô–ù–ï–†–ò–ó–ê–¶–ò–ò –ò –í–ò–†–¢–£–ê–õ–ò–ó–ê–¶–ò–ò

### 9.1. Docker/LXC –±–µ–∑ –∑–∞—â–∏—Ç—ã
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ capabilities
- Docker socket –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- –ü–æ—Ä—Ç 2375 –æ—Ç–∫—Ä—ã—Ç –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Docker
cat /etc/docker/daemon.json
docker ps
groups
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –≥—Ä—É–ø–ø—ã docker
sudo deluser admin docker
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Docker
sudo nano /etc/docker/daemon.json
# {
#   "hosts": ["unix:///var/run/docker.sock"]
# }
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker stop vulnerable-container
docker rm vulnerable-container
```

---

## üõ° 10. –û–®–ò–ë–ö–ò –†–ï–ó–ï–†–í–ù–û–ì–û –ö–û–ü–ò–†–û–í–ê–ù–ò–Ø

### 10.1. –ù–µ–Ω–∞–¥—ë–∂–Ω—ã–µ –∏–ª–∏ –Ω–µ—á–∏—Ç–∞–µ–º—ã–µ –±—ç–∫–∞–ø—ã
- –ù–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –ë—ç–∫–∞–ø—ã –Ω–µ —à–∏—Ñ—Ä—É—é—Ç—Å—è
- –ë—ç–∫–∞–ø—ã –ª–µ–∂–∞—Ç –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ –±—ç–∫–∞–ø–æ–≤
cat /usr/local/bin/backup.sh
ls -la /home/admin/backup.*
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤
sudo apt install gpg
# –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –±—ç–∫–∞–ø–∞ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
# –†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
```

---

## üõ° 11. –û–®–ò–ë–ö–ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò –Ø–î–†–ê –ò –û–°

### 11.1. –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã
- AppArmor –≤—ã–∫–ª—é—á–µ–Ω
- Kernel hardening —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã
- sysctl-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ASLR –æ—Ç–∫–ª—é—á–µ–Ω

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ AppArmor
systemctl status apparmor
# –ü—Ä–æ–≤–µ—Ä–∫–∞ sysctl –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
sysctl kernel.dmesg_restrict
sysctl kernel.randomize_va_space
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –í–∫–ª—é—á–µ–Ω–∏–µ AppArmor
sudo systemctl enable apparmor
sudo systemctl start apparmor
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ kernel hardening
sudo nano /etc/sysctl.d/99-hardening.conf
# kernel.dmesg_restrict = 1
# kernel.kptr_restrict = 2
# kernel.randomize_va_space = 2
# net.ipv4.ip_forward = 0
sudo sysctl -p /etc/sysctl.d/99-hardening.conf
```

### 11.2. –£—Å—Ç–∞—Ä–µ–≤—à–µ–µ —è–¥—Ä–æ
- –Ø–¥—Ä–æ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ HWE –ø–∞–∫–µ—Ç—ã

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ —è–¥—Ä–∞
uname -r
apt list --upgradable | grep linux-image
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —è–¥—Ä–∞
sudo apt update
sudo apt upgrade linux-image-generic
sudo reboot
```

---

## üõ° 12. –§–ò–ó–ò–ß–ï–°–ö–ê–Ø –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –î–û–°–¢–£–ü

### 12.1. –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω —Ñ–∏–∑–∏—á–µ—Å–∫–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è —Å USB
- –ù–µ—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–æ–≤ (LUKS)
- –ù–µ—Ç BIOS/UEFI –ø–∞—Ä–æ–ª—è

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–æ–≤
lsblk
sudo cryptsetup status /dev/sda1
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∏)
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ LUKS –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ BIOS/UEFI –ø–∞—Ä–æ–ª—è
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å USB –≤ BIOS
```

---

## –ü–æ–ª–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π Ubuntu Server

–î–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PAM-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–∞—Ä–æ–ª–µ–π
2. ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ fail2ban –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSH
3. ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ UFW
4. ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
5. ‚úÖ –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Å–ª—É–∂–±
6. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º
7. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Apache
8. ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
9. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ Docker
10. ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤
11. ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ AppArmor –∏ kernel hardening
12. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## Windows Server 2016 (192.168.100.20)

### –û–ø–∏—Å–∞–Ω–∏–µ
Windows Server 2016 –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å —Ç–∏–ø–∏—á–Ω—ã–º–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—è–º–∏ –û–° Windows, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –¥–æ–ø—É—Å–∫–∞—é—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã. –í—Å–µ–≥–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ 10 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –æ—à–∏–±–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ú–∞—à–∏–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏ —Å Ubuntu Server –∏ Windows 10 Pro, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –º–µ–∂—Å–∏—Å—Ç–µ–º–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏, —Å–µ—Ç–µ–≤—ã–µ –∞—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ SMB, RDP –∏ –¥—Ä—É–≥–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã, –∞ —Ç–∞–∫–∂–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏.

---

## üõ° 1. –£–Ø–ó–í–ò–ú–û–°–¢–ò –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ò –ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –£–ß–Å–¢–ù–´–ú–ò –ó–ê–ü–ò–°–Ø–ú–ò

### 1.1. –û—à–∏–±–∫–∏ —Å –ø–∞—Ä–æ–ª—è–º–∏

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–∞–±—ã—Ö –∏–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π
- –ü–∞—Ä–æ–ª—å Administrator: `Admin123!`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `admin` —Å –ø–∞—Ä–æ–ª–µ–º `admin123`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `user1` —Å –ø–∞—Ä–æ–ª–µ–º `password123`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `domainadmin` —Å –ø–∞—Ä–æ–ª–µ–º `Domain123!`

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
Get-LocalUser
# –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ —Å —Å–ª–∞–±—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–∞—Ä–æ–ª–µ–π —á–µ—Ä–µ–∑ GPO
# –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: 12 —Å–∏–º–≤–æ–ª–æ–≤
# –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: –≤–∫–ª—é—á–µ–Ω—ã
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters" -Name "MinimumPasswordLength" -Value 12
```

#### –ù–µ –≤–∫–ª—é—á–µ–Ω–∞ –ø–æ–ª–∏—Ç–∏–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è: 0
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–∞—Ä–æ–ª–µ–π
Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters" | Select-Object MinimumPasswordLength, PasswordComplexity
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª–µ–π
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters" -Name "MinimumPasswordLength" -Value 12
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters" -Name "PasswordComplexity" -Value 1
```

#### –ù–µ—Ç –∑–∞–ø—Ä–µ—Ç–∞ –Ω–∞ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è/—Ä–∞–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
- PasswordHistoryLength = 0

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ó–∞–ø—Ä–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –ø–∞—Ä–æ–ª–µ–π (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 24)
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters" -Name "PasswordHistoryLength" -Value 24
```

#### –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å—Ä–æ–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª–µ–π
- –í—Å–µ –ø–∞—Ä–æ–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –±–µ–∑ —Å—Ä–æ–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–æ–≤ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª–µ–π
Get-LocalUser | Select-Object Name, PasswordExpires
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª–µ–π (90 –¥–Ω–µ–π)
Set-LocalUser -Name "admin" -PasswordExpires $true
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ GPO: MaximumPasswordAge = 90
```

### 1.2. –û—à–∏–±–∫–∏ —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
- –í—Å–µ —Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–∞—Ä–æ–ª—å `Admin123!`

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–∞—Ä–æ–ª—è—Ö
Get-Content C:\Public\password_reuse.txt
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ LAPS (Local Administrator Password Solution)
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Azure AD Password Protection
```

#### –†–∞–±–æ—Ç–∞ –≤ —Å–µ—Ç–∏ –ø–æ–¥ —É—á—ë—Ç–∫–æ–π Domain Admin –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –∑–∞–¥–∞—á
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `domainadmin` —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥ Domain Admin –¥–ª—è –≤—Å–µ—Ö –∑–∞–¥–∞—á

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Domain Admin
Get-Content C:\Public\domain_admin_usage.txt
# –ê—É–¥–∏—Ç –≤—Ö–æ–¥–∞ Domain Admins
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Privileged Access Workstations (PAW)
# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π: Domain Admins, Server Admins, Application Admins
```

#### –ù–µ —Å–æ–∑–¥–∞–Ω–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π
- –ê–¥–º–∏–Ω –¥–æ–º–µ–Ω–∞ = –∞–¥–º–∏–Ω —Å–µ—Ä–≤–µ—Ä–æ–≤ = –∞–¥–º–∏–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø:
# - Domain Admins (—Ç–æ–ª—å–∫–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–º–µ–Ω–æ–º)
# - Server Admins (—Ç–æ–ª—å–∫–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞–º–∏)
# - Application Admins (—Ç–æ–ª—å–∫–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏)
```

#### –ù–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞–¥–º–∏–Ω-—É—á—ë—Ç–æ–∫ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∑–∞–¥–∞—á (PAW / tiering)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Privileged Access Workstations (PAW)
# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ tiering (Tier 0, Tier 1, Tier 2)
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Just-In-Time (JIT) –¥–æ—Å—Ç—É–ø–∞
```

### 1.3. –û—à–∏–±–∫–∏ MFA

#### MFA –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∏ –¥–ª—è –æ–¥–Ω–æ–π –∫—Ä–∏—Ç–∏—á–Ω–æ–π —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MFA —á–µ—Ä–µ–∑ Azure AD
# –ó–∞—â–∏—Ç–∞ –≤—Å–µ—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Conditional Access Policies
```

#### –ù–µ –∑–∞—â–∏—â–µ–Ω—ã Emergency / Break-glass –∞–∫–∫–∞—É–Ω—Ç—ã

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ó–∞—â–∏—Ç–∞ Break-glass –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Break-glass –∞–∫–∫–∞—É–Ω—Ç–æ–≤
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Break-glass –∞–∫–∫–∞—É–Ω—Ç–æ–≤
```

---

## üõ° 2. –û–®–ò–ë–ö–ò –í –ù–ê–°–¢–†–û–ô–ö–ï –ü–û–õ–ò–¢–ò–ö –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò (GPO)

### 2.1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ GPO, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

#### –†–∞–∑—Ä–µ—à–µ–Ω—ã WMI/PowerShell Remoting –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- PowerShell Remoting –≤–∫–ª—é—á–µ–Ω –¥–ª—è –≤—Å–µ—Ö
- TrustedHosts = "*"

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ PowerShell Remoting
Get-Item WSMan:\localhost\Client\TrustedHosts
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ TrustedHosts –ø–æ IP
Set-Item WSMan:\localhost\Client\TrustedHosts -Value "192.168.100.0/24"
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Just Enough Administration (JEA)
```

#### –û—Ç–∫–ª—é—á—ë–Ω –∞—É–¥–∏—Ç —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- Event logs –æ—á–∏—â–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- Retention = 0

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∞—É–¥–∏—Ç–∞
Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Eventlog\Security" | Select-Object Retention
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –í–∫–ª—é—á–µ–Ω–∏–µ –∞—É–¥–∏—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Retention –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Eventlog\Security" -Name "Retention" -Value 1
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ª–æ–≥–æ–≤
```

#### –†–∞–∑—Ä–µ—à–µ–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –≤ GPP (Group Policy Preferences)
- –£—è–∑–≤–∏–º–æ—Å—Ç—å CVE-2014-1812
- –ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ SYSVOL

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü–æ–∏—Å–∫ –ø–∞—Ä–æ–ª–µ–π –≤ GPP
Get-ChildItem -Path "\\domain\SYSVOL\domain\Policies" -Recurse -Include *.xml | Select-String -Pattern "cpassword"
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –£–¥–∞–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –∏–∑ GPP
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Group Managed Service Accounts (gMSA)
# –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
```

#### –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫—É –Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–¥–ø–∏—Å–∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Driver Signing" | Select-Object Policy
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Driver Signing" -Name "Policy" -Value 1
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ GPO: Device Installation Restrictions
```

### 2.2. –°–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏

#### GPO –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º OU –≤–º–µ—Å—Ç–æ –Ω—É–∂–Ω—ã—Ö –≥—Ä—É–ø–ø

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ GPO —Ç–æ–ª—å–∫–æ –∫ –Ω—É–∂–Ω—ã–º –≥—Ä—É–ø–ø–∞–º
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ GPO
# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ GPO –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –≥—Ä—É–ø–ø–∞–º
```

#### –ß—Ä–µ–∑–º–µ—Ä–Ω—ã–µ –ø—Ä–∞–≤–∞ –≤ "Allow log on locally", "Allow log on through RDP"

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤ "Allow log on locally"
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤ "Allow log on through RDP"
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø –≤–º–µ—Å—Ç–æ "Everyone" –∏–ª–∏ "Authenticated Users"
```

---

## üõ° 3. –û–®–ò–ë–ö–ò –í –£–ü–†–ê–í–õ–ï–ù–ò–ò –ü–†–ê–í–ê–ú–ò (ACL, –î–ï–õ–ï–ì–ò–†–û–í–ê–ù–ò–ï, –ì–†–£–ü–ü–´)

### 3.1. –°–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–∏–µ –ø—Ä–∞–≤–∞ –Ω–∞ AD-–æ–±—ä–µ–∫—Ç—ã

#### Authenticated Users –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ ACL –Ω–∞ AD –æ–±—ä–µ–∫—Ç–∞—Ö
Get-Acl "AD:\CN=Users,DC=domain,DC=local" | Format-List
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ Authenticated Users –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ACL –Ω–∞ –≤—Å–µ—Ö AD –æ–±—ä–µ–∫—Ç–∞—Ö
# –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
```

#### WriteDacl/WriteOwner –Ω–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ OU –∏–ª–∏ –≥—Ä—É–ø–ø—ã

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –£–¥–∞–ª–µ–Ω–∏–µ WriteDacl/WriteOwner –ø—Ä–∞–≤
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Protected Users –≥—Ä—É–ø–ø—ã
```

#### –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ–∑–≤–æ–ª—è—è –ø–æ–≤—ã—à–∞—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Constrained Delegation
```

### 3.2. –ß—Ä–µ–∑–º–µ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø

#### Domain Admins –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤—Å–µ–≥–æ –ø–æ–¥—Ä—è–¥

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ Domain Admins
Get-ADGroupMember -Identity "Domain Admins"
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ Domain Admins
# –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
```

#### Administrators/SysAdmins –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ê—É–¥–∏—Ç —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ –≥—Ä—É–ø–ø–∞—Ö Administrators
# –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –ø—Ä–∞–≤
# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–µ–≤—ã—Ö –≥—Ä—É–ø–ø
```

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –≥—Ä—É–ø–ø–µ Enterprise Admins –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ Enterprise Admins
Get-ADGroupMember -Identity "Enterprise Admins"
# –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
```

### 3.3. Unconstrained Delegation

#### –£ —Ö–æ—Å—Ç–æ–≤ –≤–∫–ª—é—á–µ–Ω–æ "Trust this computer for delegation to any service"

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü–æ–∏—Å–∫ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ —Å Unconstrained Delegation
Get-ADComputer -Filter {TrustedForDelegation -eq $true} -Properties TrustedForDelegation
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ Unconstrained Delegation
Set-ADComputer -Identity "ComputerName" -TrustedForDelegation $false
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Constrained Delegation –∏–ª–∏ Resource-Based Constrained Delegation
```

#### –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ SPN –Ω–∞ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–∞—Ö

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü–æ–∏—Å–∫ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö SPN
Get-ADUser -Filter * -Properties ServicePrincipalName | Where-Object {$_.ServicePrincipalName -ne $null}
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö SPN
Set-ADUser -Identity "ServiceAccount" -ServicePrincipalName @()
```

---

## üõ° 4. –£–Ø–ó–í–ò–ú–û–°–¢–ò –ò–ó-–ó–ê –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û–ô –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò –°–ï–¢–ò

### 4.1. –û—à–∏–±–∫–∏ DNS

#### –†–∞–∑—Ä–µ—à–µ–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ DNS –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ DNS
Get-DnsServerZone | Select-Object ZoneName, DynamicUpdate
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π DNS
Set-DnsServerZone -Name "domain.local" -DynamicUpdate Secure
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö ACL –Ω–∞ DNS –∑–∞–ø–∏—Å–∏
```

#### –û—Ç–∫—Ä—ã—Ç—ã–π DNS –∫ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ DNS —Å–µ—Ä–≤–µ—Ä—É
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Network Security Groups
```

#### –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ ACL –Ω–∞ DNS-–∑–∞–ø–∏—Å–∏, —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–∑–≤–æ–ª–∏—Ç—å "DNS poisoning"

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ ACL –Ω–∞ DNS –∑–∞–ø–∏—Å—è—Ö
# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö ACL
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DNSSEC
```

### 4.2. –û—à–∏–±–∫–∏ –≤ Firewall

#### –î–æ–ø—É—â–µ–Ω—ã —à–∏—Ä–æ–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞: Any ‚Üí Any

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞
Get-NetFirewallRule | Where-Object {$_.RemoteAddress -eq "Any"}
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –£–¥–∞–ª–µ–Ω–∏–µ —à–∏—Ä–æ–∫–∏—Ö –ø—Ä–∞–≤–∏–ª
Remove-NetFirewallRule -DisplayName "Unsafe Rule"
# –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –ø–æ IP
```

#### –ù–µ—Ç —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏: –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –¥–æ–º–µ–Ω–∞ (DC) –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ –≤—Å–µ—Ö —Å–µ—Ç–µ–π

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ DC —Ç–æ–ª—å–∫–æ –∏–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π
New-NetFirewallRule -DisplayName "DC Access" -Direction Inbound -RemoteAddress "192.168.100.0/24" -Action Allow
```

#### RDP –æ—Ç–∫—Ä—ã—Ç –Ω–∞—Ä—É–∂—É

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ó–∞–∫—Ä—ã—Ç–∏–µ RDP –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ç–µ–π
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ VPN –¥–ª—è –¥–æ—Å—Ç—É–ø–∞
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ RDP –ø–æ IP
```

### 4.3. SMB –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π

#### SMBv1 –≤–∫–ª—é—á—ë–Ω

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ SMBv1
Get-WindowsOptionalFeature -Online -FeatureName SMB1Protocol
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ SMBv1
Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol -NoRestart
```

#### NTLMv1 —Ä–∞–∑—Ä–µ—à—ë–Ω

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ NTLM
Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa" | Select-Object LmCompatibilityLevel
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ NTLMv1, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ NTLMv2
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa" -Name "LmCompatibilityLevel" -Value 5
# –ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ: –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ NTLM, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ Kerberos
```

#### LDAP –±–µ–∑ TLS

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –í–∫–ª—é—á–µ–Ω–∏–µ LDAPS (LDAP over TLS)
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –¥–ª—è LDAPS
# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ LDAPS
```

---

## üõ° 5. –û–®–ò–ë–ö–ò –ü–†–ò –ù–ê–°–¢–†–û–ô–ö–ï –ö–û–ù–¢–†–û–õ–õ–ï–†–û–í –î–û–ú–ï–ù–ê (DC)

### 5.1. DC –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω—ã–µ —Ä–∞–±–æ—á–∏–µ —Å–µ—Ä–≤–µ—Ä–∞

#### –†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã —Ä–æ–ª–∏ DHCP, SQL, —Ñ–∞–π–ª–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –≤—Å—ë –Ω–∞ DC

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π
Get-WindowsFeature | Where-Object {$_.InstallState -eq "Installed"}
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–æ–ª–µ–π –∫—Ä–æ–º–µ AD DS —Å DC
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–æ–ª–µ–π
# –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ä–æ–ª–µ–π
```

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∑–∞—Ö–æ–¥–∏—Ç—å –Ω–∞ DC –ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ –ø–æ RDP

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ó–∞–ø—Ä–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –Ω–∞ DC
# –ó–∞–ø—Ä–µ—Ç RDP –Ω–∞ DC
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–Ω—Ü–∏–π (PAW)
```

### 5.2. –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è

#### –†–∞–∑—Ä–µ—à—ë–Ω RPC –≤–æ –≤—Å–µ —Å—Ç–æ—Ä–æ–Ω—ã

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ RPC —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É DC
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ –¥–ª—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏
```

#### DFSR –∏–ª–∏ SYSVOL –Ω–µ –∑–∞—â–∏—â–µ–Ω—ã –Ω–∞–¥–ª–µ–∂–∞—â–∏–º–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ SYSVOL
Get-Acl "\\domain\SYSVOL" | Format-List
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ SYSVOL
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DFSR –≤–º–µ—Å—Ç–æ FRS
```

### 5.3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –∑–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º –¥–æ—Å—Ç—É–ø–æ–º

#### –°–µ—Ä–≤–µ—Ä—ã –∏–ª–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã DC –¥–æ—Å—Ç—É–ø–Ω—ã —à–∏—Ä–æ–∫–æ–º—É –∫—Ä—É–≥—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ DC
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ BitLocker –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–æ–≤ DC
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ BIOS/UEFI –ø–∞—Ä–æ–ª–µ–π
```

---

## üõ° 6. –û–®–ò–ë–ö–ò –í –†–ê–ë–û–¢–ï –° –û–ë–ù–û–í–õ–ï–ù–ò–Ø–ú–ò –ò –ê–ù–¢–ò–í–ò–†–£–°–û–ú

### 6.1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

#### –ù–µ—Ç WSUS/SCCM –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ç—á–∞–º–∏

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
Get-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU"
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WSUS –∏–ª–∏ SCCM
# –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º
```

#### DC –∏ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–µ—Å—è—Ü–∞–º–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –ø–∞—Ç—á–∏–Ω–≥–∞
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
```

### 6.2. –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ

#### –ò—Å–∫–ª—é—á–µ–Ω–∏—è –≤ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–µ –≤–∫–ª—é—á–∞—é—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø—É—Ç–µ–π

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤ Windows Defender
Get-MpPreference | Select-Object ExclusionPath
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏–π
Remove-MpPreference -ExclusionPath "C:\", "D:\"
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
```

#### –ù–µ –≤–∫–ª—é—á–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ (ASR rules)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –í–∫–ª—é—á–µ–Ω–∏–µ ASR –ø—Ä–∞–≤–∏–ª
Set-MpPreference -AttackSurfaceReductionRules_Ids @{0="75668C1F-73B5-4CF0-B93E-0E77F077116"} -AttackSurfaceReductionRules_Actions @{0="Block"}
```

---

## üõ° 7. –£–Ø–ó–í–ò–ú–û–°–¢–ò –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø, –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê –ò –ê–£–î–ò–¢–ê

### 7.1. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

#### Event logs –æ—á–∏—â–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ª–æ–≥–æ–≤
Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Eventlog\Application" | Select-Object Retention
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Retention –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Eventlog\Application" -Name "Retention" -Value 1
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ª–æ–≥–æ–≤
```

#### –ù–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–æ–≤ –Ω–∞ SIEM –∏–ª–∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥-—Å–µ—Ä–≤–µ—Ä

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–æ–≤ –Ω–∞ SIEM
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Windows Event Forwarding
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```

#### –ê—É–¥–∏—Ç –æ—Ç–∫–ª—é—á—ë–Ω –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç–∏—á–Ω–æ

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –í–∫–ª—é—á–µ–Ω–∏–µ –∞—É–¥–∏—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
auditpol /set /category:"Logon/Logoff" /success:enable /failure:enable
auditpol /set /category:"Account Management" /success:enable /failure:enable
auditpol /set /category:"Policy Change" /success:enable /failure:enable
```

### 7.2. –ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∞–Ω–æ–º–∞–ª–∏–π

#### –ù–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –≤—Ö–æ–¥—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤—Ö–æ–¥–æ–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Microsoft Defender for Identity
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤ –Ω–∞ –≤—Ö–æ–¥—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
```

#### –ù–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø–∞—Ö

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –≥—Ä—É–ø–ø–∞—Ö Domain Admins, Enterprise Admins
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–∞—Ö
```

#### –ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ NTDS.dit –∏–ª–∏ –ø–æ–ø—ã—Ç–æ–∫ –µ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–∞ –∫ NTDS.dit
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤ –Ω–∞ –ø–æ–ø—ã—Ç–∫–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è NTDS.dit
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Microsoft Defender for Identity
```

---

## üõ° 8. –û–®–ò–ë–ö–ò –í –†–ï–ó–ï–†–í–ù–û–ú –ö–û–ü–ò–†–û–í–ê–ù–ò–ò

### 8.1. –ë—ç–∫–∞–ø—ã –ª–µ–∂–∞—Ç –≤ –¥–æ–º–µ–Ω–µ –∏ –Ω–µ –∑–∞—â–∏—â–µ–Ω—ã

#### –ù–µ—Ç offline/immutable backup

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –•—Ä–∞–Ω–µ–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤ –≤–Ω–µ –¥–æ–º–µ–Ω–∞
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ immutable storage
# –†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
```

#### –°–∞–º–∏ –±—ç–∫–∞–ø—ã –Ω–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ BitLocker –¥–ª—è –±—ç–∫–∞–ø–æ–≤
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â
```

### 8.2. –ù–µ –¥–µ–ª–∞—é—Ç—Å—è –±—ç–∫–∞–ø—ã –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

#### SYSVOL –Ω–µ –±—ç–∫–∞–ø–∏—Ç—Å—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –±—ç–∫–∞–ø–∏—Ä–æ–≤–∞–Ω–∏–µ SYSVOL
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è SYSVOL
```

#### DNS –Ω–µ –±—ç–∫–∞–ø–∏—Ç—Å—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –±—ç–∫–∞–ø–∏—Ä–æ–≤–∞–Ω–∏–µ DNS
# –≠–∫—Å–ø–æ—Ä—Ç DNS –∑–æ–Ω
```

#### GPO –Ω–µ –±—ç–∫–∞–ø—è—Ç—Å—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –±—ç–∫–∞–ø–∏—Ä–æ–≤–∞–Ω–∏–µ GPO
# –≠–∫—Å–ø–æ—Ä—Ç GPO —á–µ—Ä–µ–∑ Group Policy Management Console
```

#### –û–±—Ä–∞–∑—ã DC –Ω–µ –±—ç–∫–∞–ø—è—Ç—Å—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –±—ç–∫–∞–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤ DC
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ System State Backup
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è DC
```

---

## üõ° 9. –û–®–ò–ë–ö–ò –ü–†–ò –†–ê–ë–û–¢–ï –° –°–ï–†–í–ò–°–ù–´–ú–ò –ê–ö–ö–ê–£–ù–¢–ê–ú–ò

### 9.1. –°–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ Domain Admin

#### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç –∏–º–µ–Ω–∏ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–æ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü–æ–∏—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –æ—Ç –∏–º–µ–Ω–∏ Domain Admin
Get-WmiObject Win32_Service | Where-Object {$_.StartName -like "*Domain Admin*"}
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Group Managed Service Accounts (gMSA)
# –ü—Ä–∏–Ω—Ü–∏–ø –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
# –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
```

### 9.2. –ü–∞—Ä–æ–ª–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è –≥–æ–¥–∞–º–∏

#### –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (gMSA)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ gMSA (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π)
# –ú–∏–≥—Ä–∞—Ü–∏—è –æ–±—ã—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –Ω–∞ gMSA
New-ADServiceAccount -Name "svc_app" -DNSHostName "svc_app.domain.local"
```

### 9.3. SPN –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

#### –£ —Å—á–µ—Ç–æ–≤ —Å SPN —Å–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü–æ–∏—Å–∫ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —Å SPN
Get-ADUser -Filter * -Properties ServicePrincipalName | Where-Object {$_.ServicePrincipalName -ne $null}
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SPN
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –¥–ª—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —Å SPN
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Constrained Delegation
```

---

## üõ° 10. –£–°–¢–ê–†–ï–í–®–ò–ï –ò –ù–ï–ë–ï–ó–û–ü–ê–°–ù–´–ï –¢–ï–•–ù–û–õ–û–ì–ò–ò

### 10.1. NTLM –≤–º–µ—Å—Ç–æ Kerberos

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è NTLM
Get-WinEvent -LogName Security | Where-Object {$_.Message -like "*NTLM*"}
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ NTLM, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ Kerberos
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0" -Name "NtlmMinClientSec" -Value 537395200
```

### 10.2. FRS –≤–º–µ—Å—Ç–æ DFSR –¥–ª—è SYSVOL

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è FRS
Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\DFSR" | Select-Object *
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –ú–∏–≥—Ä–∞—Ü–∏—è —Å FRS –Ω–∞ DFSR
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Dfsrmig.exe –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏
```

### 10.3. Windows Server 2008/2012 –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –≤–µ—Ä—Å–∏–π Windows Server
# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Extended Security Updates (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
```

### 10.4. –û—Ç–∫—Ä—ã—Ç—ã–µ SMB-—Å–µ—Ä–≤–µ—Ä–∞ –±–µ–∑ –ø–æ–¥–ø–∏—Å—ã–≤–∞–Ω–∏—è

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ SMB signing
Get-SmbServerConfiguration | Select-Object RequireSecuritySignature
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –í–∫–ª—é—á–µ–Ω–∏–µ SMB signing
Set-SmbServerConfiguration -RequireSecuritySignature $true -Force
```

---

## –ü–æ–ª–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π Windows Server 2016

–î–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–∞—Ä–æ–ª–µ–π –∏ MFA
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ GPO –∏ –ø–æ–ª–∏—Ç–∏–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (ACL, –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –≥—Ä—É–ø–ø—ã)
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ç–∏ (DNS, Firewall, SMB)
5. ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –¥–æ–º–µ–Ω–∞
6. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∏ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞
7. ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
8. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
9. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
10. ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è —Å —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

## Windows 10 Pro (192.168.100.30)

### –û–ø–∏—Å–∞–Ω–∏–µ
Windows 10 Pro –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å —Ç–∏–ø–∏—á–Ω—ã–º–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—è–º–∏ —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–Ω—Ü–∏–π Windows. –ú–∞—à–∏–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–µ—Ç–∏ 192.168.100.0/24 –≤–º–µ—Å—Ç–µ —Å Ubuntu Server –∏ Windows Server 2016, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º –∏ –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

### –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

#### 1. –û—Ç–∫–ª—é—á–µ–Ω UAC (User Account Control)
- –†–µ–µ—Å—Ç—Ä: `HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA = 0`

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ UAC
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" | Select-Object EnableLUA
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```powershell
# –í–∫–ª—é—á–µ–Ω–∏–µ UAC
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "EnableLUA" -Value 1
```

### –û—Å—Ç–∞–ª—å–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã Windows Server 2016 (—Å–ª–∞–±—ã–µ –ø–∞—Ä–æ–ª–∏, –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, SMBv1, –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–π –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä –∏ —Ç.–¥.)

