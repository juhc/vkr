# Примерный вывод скрипта проверки исправлений

## Пример 1: Частично исправленные уязвимости

```
==========================================
Проверка исправлений уязвимостей
==========================================

=== Ubuntu Server (192.168.100.10) ===

Проверка доступности...
✓ Ubuntu Server доступен

1. Проверка аутентификации:
✓ Root login отключен
✓ Парольная аутентификация отключена
✗ PAM ограничения включены (ожидалось true, получено false)
✓ Fail2ban установлен и запущен

2. Проверка SSH:
✓ MaxAuthTries <= 6
✓ Слабые алгоритмы отключены

3. Проверка сети и firewall:
✓ UFW включен
✓ Небезопасные порты закрыты

4. Проверка обновлений:
✓ Автоматические обновления включены

5. Проверка прав доступа:
✓ /etc имеет правильные права (755)
✓ /var имеет правильные права (755)
✗ /etc/shadow имеет правильные права (640) (ожидалось true, получено false)
✓ Нет директорий с правами 777

6. Проверка служб:
✓ AppArmor включен
✓ Лишние службы отключены

7. Проверка веб-сервисов:
✓ Directory listing отключен
✓ ServerTokens установлен в Prod

8. Проверка логирования:
✓ rsyslog включен

9. Проверка Docker:
✓ Пользователи не в группе docker

10. Проверка безопасности ядра:
✓ ASLR включен (randomize_va_space = 2)


=== Windows Server 2016 (192.168.100.20) ===

Проверка доступности...
✓ Windows Server 2016 доступен
✓ RDP порт открыт (3389)
✓ WinRM порт открыт (5985)

Примечание: Для полной проверки Windows требуется настроенный WinRM
Используйте Ansible для детальной проверки:
  ansible-playbook -i inventory.yml verify-fixes.yml


=== Windows 10 Pro (192.168.100.30) ===

Проверка доступности...
✓ Windows 10 Pro доступен
✓ RDP порт открыт (3389)
✓ WinRM порт открыт (5985)

==========================================
Итоговый отчет
==========================================

Всего проверок: 25
Пройдено: 23
Провалено: 2
Пропущено: 0

✗ Обнаружены неисправленные уязвимости.

Рекомендации:
1. Проверьте документацию: docs/overview/machine-scenarios.md
2. Используйте чек-лист: docs/assessment/CHECKLIST.md
3. Проверьте тестирование: docs/assessment/TESTING.md
```

---

## Пример 2: Все уязвимости исправлены

```
==========================================
Проверка исправлений уязвимостей
==========================================

=== Ubuntu Server (192.168.100.10) ===

Проверка доступности...
✓ Ubuntu Server доступен

1. Проверка аутентификации:
✓ Root login отключен
✓ Парольная аутентификация отключена
✓ PAM ограничения включены
✓ Fail2ban установлен и запущен

2. Проверка SSH:
✓ MaxAuthTries <= 6
✓ Слабые алгоритмы отключены

3. Проверка сети и firewall:
✓ UFW включен
✓ Небезопасные порты закрыты

4. Проверка обновлений:
✓ Автоматические обновления включены

5. Проверка прав доступа:
✓ /etc имеет правильные права (755)
✓ /var имеет правильные права (755)
✓ /etc/shadow имеет правильные права (640)
✓ Нет директорий с правами 777

6. Проверка служб:
✓ AppArmor включен
✓ Лишние службы отключены

7. Проверка веб-сервисов:
✓ Directory listing отключен
✓ ServerTokens установлен в Prod

8. Проверка логирования:
✓ rsyslog включен

9. Проверка Docker:
✓ Пользователи не в группе docker

10. Проверка безопасности ядра:
✓ ASLR включен (randomize_va_space = 2)


=== Windows Server 2016 (192.168.100.20) ===

Проверка доступности...
✓ Windows Server 2016 доступен
✓ RDP порт открыт (3389)
✓ WinRM порт открыт (5985)

Примечание: Для полной проверки Windows требуется настроенный WinRM
Используйте Ansible для детальной проверки:
  ansible-playbook -i inventory.yml verify-fixes.yml


=== Windows 10 Pro (192.168.100.30) ===

Проверка доступности...
✓ Windows 10 Pro доступен
✓ RDP порт открыт (3389)
✓ WinRM порт открыт (5985)

==========================================
Итоговый отчет
==========================================

Всего проверок: 25
Пройдено: 25
Провалено: 0
Пропущено: 0

✓ Все проверки пройдены успешно!
```

---

## Пример 3: Детальная проверка через Ansible (Ubuntu Server)

```
PLAY [Проверка исправлений уязвимостей Ubuntu Server] *************************

TASK [Gathering Facts] *********************************************************
ok: [ubuntu-server]

TASK [Сбор информации о системе] **********************************************
ok: [ubuntu-server] => {
    "msg": "Проверка Ubuntu Server ubuntu-server-training"
}

TASK [Проверка - Root login отключен] ******************************************
ok: [ubuntu-server]

TASK [Проверка - Парольная аутентификация отключена] ***************************
ok: [ubuntu-server]

TASK [Проверка - PAM ограничения включены] ***********************************
ok: [ubuntu-server]

TASK [Проверка - Fail2ban установлен и запущен] ******************************
ok: [ubuntu-server]

TASK [Проверка - MaxAuthTries <= 6] *******************************************
ok: [ubuntu-server]

TASK [Проверка значения MaxAuthTries] *****************************************
ok: [ubuntu-server] => {
    "changed": false,
    "msg": "MaxAuthTries настроен правильно"
}

TASK [Проверка - Слабые алгоритмы отключены] **********************************
ok: [ubuntu-server]

TASK [Проверка - UFW включен] **************************************************
ok: [ubuntu-server]

TASK [Проверка статуса UFW] ****************************************************
ok: [ubuntu-server] => {
    "changed": false,
    "msg": "UFW включен"
}

TASK [Проверка - Небезопасные порты закрыты] **********************************
ok: [ubuntu-server]

TASK [Проверка отсутствия небезопасных портов] ********************************
ok: [ubuntu-server] => {
    "changed": false,
    "msg": "Небезопасные порты закрыты"
}

TASK [Проверка - Автоматические обновления включены] **************************
ok: [ubuntu-server]

TASK [Проверка содержимого файла автоматических обновлений] *******************
ok: [ubuntu-server]

TASK [Проверка настройки автоматических обновлений] ***************************
ok: [ubuntu-server] => {
    "changed": false,
    "msg": "Автоматические обновления включены"
}

TASK [Проверка - /etc имеет правильные права] *********************************
ok: [ubuntu-server]

TASK [Проверка прав /etc] ******************************************************
ok: [ubuntu-server] => {
    "changed": false,
    "msg": "/etc имеет правильные права"
}

TASK [Проверка - /var имеет правильные права] *********************************
ok: [ubuntu-server]

TASK [Проверка прав /var] ******************************************************
ok: [ubuntu-server] => {
    "changed": false,
    "msg": "/var имеет правильные права"
}

TASK [Проверка - /etc/shadow имеет правильные права] ***************************
ok: [ubuntu-server]

TASK [Проверка прав /etc/shadow] **********************************************
ok: [ubuntu-server] => {
    "changed": false,
    "msg": "/etc/shadow имеет правильные права"
}

TASK [Проверка - Нет директорий с правами 777] *********************************
ok: [ubuntu-server]

TASK [Проверка отсутствия директорий с правами 777] **************************
ok: [ubuntu-server] => {
    "changed": false,
    "msg": "Нет директорий с правами 777"
}

TASK [Проверка - AppArmor включен] *********************************************
ok: [ubuntu-server]

TASK [Проверка статуса AppArmor] ***********************************************
ok: [ubuntu-server] => {
    "changed": false,
    "msg": "AppArmor включен"
}

TASK [Проверка - Лишние службы отключены] **************************************
ok: [ubuntu-server] => (item=cups)
ok: [ubuntu-server] => (item=avahi-daemon)
ok: [ubuntu-server] => (item=bluetooth)

TASK [Проверка отключения лишних служб] ****************************************
ok: [ubuntu-server] => (item={'item': 'cups', 'status': {'ActiveState': 'inactive', ...}})
ok: [ubuntu-server] => (item={'item': 'avahi-daemon', 'status': {'ActiveState': 'inactive', ...}})
ok: [ubuntu-server] => (item={'item': 'bluetooth', 'status': {'ActiveState': 'inactive', ...}})

TASK [Проверка - Directory listing отключен] ***********************************
ok: [ubuntu-server]

TASK [Проверка - ServerTokens установлен в Prod] ******************************
ok: [ubuntu-server]

TASK [Проверка - rsyslog включен] **********************************************
ok: [ubuntu-server]

TASK [Проверка статуса rsyslog] ************************************************
ok: [ubuntu-server] => {
    "changed": false,
    "msg": "rsyslog включен"
}

TASK [Проверка - Пользователи не в группе docker] ******************************
ok: [ubuntu-server]

TASK [Проверка членства в группе docker] **************************************
ok: [ubuntu-server] => {
    "changed": false,
    "msg": "Пользователи не в группе docker"
}

TASK [Проверка - ASLR включен] *************************************************
ok: [ubuntu-server]

TASK [Проверка значения ASLR] **************************************************
ok: [ubuntu-server] => {
    "changed": false,
    "msg": "ASLR включен"
}

TASK [Итоговый отчет] **********************************************************
ok: [ubuntu-server] => {
    "msg": "Все проверки Ubuntu Server пройдены успешно!"
}

PLAY RECAP **********************************************************************
ubuntu-server              : ok=35   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```

---

## Пример 4: Детальная проверка через Ansible (Windows Server 2016)

```
PLAY [Проверка исправлений Windows Server 2016] ******************************

TASK [Gathering Facts] *********************************************************
ok: [windows-server-2016]

TASK [Сбор информации о системе] **********************************************
ok: [windows-server-2016]

TASK [Информация о системе] ****************************************************
ok: [windows-server-2016] => {
    "msg": "Проверка Windows Server WIN-SERVER-2016"
}

TASK [Проверка - Политика паролей включена] ***********************************
ok: [windows-server-2016]

TASK [Проверка минимальной длины пароля] **************************************
ok: [windows-server-2016] => {
    "changed": false,
    "msg": "Минимальная длина пароля настроена правильно"
}

TASK [Проверка - Политика сложности паролей включена] *************************
ok: [windows-server-2016]

TASK [Проверка политики сложности] ********************************************
ok: [windows-server-2016] => {
    "changed": false,
    "msg": "Политика сложности паролей включена"
}

TASK [Проверка - PowerShell Remoting ограничен] *******************************
ok: [windows-server-2016]

TASK [Проверка TrustedHosts] ***************************************************
ok: [windows-server-2016] => {
    "changed": false,
    "msg": "TrustedHosts настроен правильно"
}

TASK [Проверка - SMBv1 отключен] ***********************************************
ok: [windows-server-2016]

TASK [Проверка статуса SMBv1] **************************************************
ok: [windows-server-2016] => {
    "changed": false,
    "msg": "SMBv1 отключен"
}

TASK [Проверка - NTLMv1 отключен] **********************************************
ok: [windows-server-2016]

TASK [Проверка уровня NTLM] ****************************************************
ok: [windows-server-2016] => {
    "changed": false,
    "msg": "NTLMv1 отключен"
}

TASK [Проверка - Брандмауэр включен] ******************************************
ok: [windows-server-2016]

TASK [Проверка статуса брандмауэра] ********************************************
ok: [windows-server-2016] => {
    "changed": false,
    "msg": "Брандмауэр включен"
}

TASK [Проверка - Windows Update настроен] *************************************
ok: [windows-server-2016]

TASK [Проверка автоматических обновлений] *************************************
ok: [windows-server-2016] => {
    "changed": false,
    "msg": "Автоматические обновления включены"
}

TASK [Итоговый отчет] **********************************************************
ok: [windows-server-2016] => {
    "msg": "Все проверки Windows Server 2016 пройдены успешно!"
}

PLAY RECAP **********************************************************************
windows-server-2016        : ok=17   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```

---

## Пример 5: Детальная проверка через Ansible (Windows 10 Pro)

```
PLAY [Проверка исправлений Windows 10 Pro] ************************************

TASK [Gathering Facts] *********************************************************
ok: [windows-10-pro]

TASK [Сбор информации о системе] **********************************************
ok: [windows-10-pro]

TASK [Информация о системе] ****************************************************
ok: [windows-10-pro] => {
    "msg": "Проверка Windows 10 Pro WIN10-CLIENT"
}

TASK [Проверка - UAC включен] **************************************************
ok: [windows-10-pro]

TASK [Проверка статуса UAC] ****************************************************
ok: [windows-10-pro] => {
    "changed": false,
    "msg": "UAC включен"
}

TASK [Проверка - Windows Defender включен] ************************************
ok: [windows-10-pro]

TASK [Проверка статуса Windows Defender] *************************************
ok: [windows-10-pro] => {
    "changed": false,
    "msg": "Windows Defender включен"
}

TASK [Проверка - SMBv1 отключен] ***********************************************
ok: [windows-10-pro]

TASK [Проверка статуса SMBv1] **************************************************
ok: [windows-10-pro] => {
    "changed": false,
    "msg": "SMBv1 отключен"
}

TASK [Итоговый отчет] **********************************************************
ok: [windows-10-pro] => {
    "msg": "Все проверки Windows 10 Pro пройдены успешно!"
}

PLAY RECAP **********************************************************************
windows-10-pro             : ok=9    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```

---

## Пример 6: Полная проверка всех машин через Ansible

```
PLAY [Проверка исправлений уязвимостей Ubuntu Server] ************************
[Проверки Ubuntu Server - см. Пример 3]

PLAY [Проверка исправлений Windows Server 2016] ******************************
[Проверки Windows Server 2016 - см. Пример 4]

PLAY [Проверка исправлений Windows 10 Pro] ************************************
[Проверки Windows 10 Pro - см. Пример 5]

PLAY RECAP **********************************************************************
ubuntu-server              : ok=35   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
windows-server-2016        : ok=17   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
windows-10-pro             : ok=9    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0

==========================================
ИТОГОВЫЙ ОТЧЕТ
==========================================

Всего проверок: 61
Пройдено: 61
Провалено: 0
Пропущено: 0

✓ Все проверки пройдены успешно!
```

---

## Пример 7: Ошибки при проверке (Ansible)

```
PLAY [Проверка исправлений уязвимостей Ubuntu Server] ************************

TASK [Проверка - Root login отключен] ******************************************
ok: [ubuntu-server]

TASK [Проверка - Парольная аутентификация отключена] ***************************
ok: [ubuntu-server]

TASK [Проверка - PAM ограничения включены] ***********************************
fatal: [ubuntu-server]: FAILED! => {"changed": false, "msg": "PAM ограничения не включены"}

TASK [Проверка - Fail2ban установлен и запущен] ******************************
ok: [ubuntu-server]

TASK [Проверка - UFW включен] **************************************************
ok: [ubuntu-server]

TASK [Проверка - /etc/shadow имеет правильные права] ***************************
fatal: [ubuntu-server]: FAILED! => {
    "changed": false,
    "msg": "/etc/shadow должен иметь права 640"
}

PLAY RECAP **********************************************************************
ubuntu-server              : ok=4    changed=0    unreachable=0    failed=2    skipped=0    rescued=0    ignored=0

==========================================
ИТОГОВЫЙ ОТЧЕТ
==========================================

Всего проверок: 35
Пройдено: 33
Провалено: 2
Пропущено: 0

✗ Обнаружены неисправленные уязвимости.

Неисправленные уязвимости:
1. PAM ограничения не включены
2. /etc/shadow имеет неправильные права доступа

Рекомендации:
1. Проверьте документацию: docs/overview/machine-scenarios.md
2. Используйте чек-лист: docs/assessment/CHECKLIST.md
3. Проверьте тестирование: docs/assessment/TESTING.md
```

---

## Пример 8: Машины недоступны

```
==========================================
Проверка исправлений уязвимостей
==========================================

=== Ubuntu Server (192.168.100.10) ===

⚠ Ubuntu Server недоступен. Пропуск проверок.


=== Windows Server 2016 (192.168.100.20) ===

⚠ Windows Server 2016 недоступен. Пропуск проверок.


=== Windows 10 Pro (192.168.100.30) ===

⚠ Windows 10 Pro недоступен. Пропуск проверок.

==========================================
Итоговый отчет
==========================================

Всего проверок: 0
Пройдено: 0
Провалено: 0
Пропущено: 3

⚠ Некоторые проверки пропущены, но все выполненные пройдены.

Рекомендации:
1. Убедитесь, что все машины запущены
2. Проверьте сетевую связность: ping 192.168.100.10
3. Проверьте SSH доступ: ssh ubuntu@192.168.100.10
```

---

## Формат отчета для преподавателей

### Структурированный отчет (JSON/CSV)

```json
{
  "timestamp": "2024-12-20T10:30:00Z",
  "student": "Иванов И.И.",
  "results": {
    "ubuntu-server": {
      "host": "192.168.100.10",
      "total_checks": 25,
      "passed": 23,
      "failed": 2,
      "skipped": 0,
      "checks": [
        {
          "category": "Аутентификация",
          "check": "Root login отключен",
          "status": "passed"
        },
        {
          "category": "Аутентификация",
          "check": "PAM ограничения включены",
          "status": "failed",
          "details": "minlen должен быть >= 12"
        }
      ]
    },
    "windows-server-2016": {
      "host": "192.168.100.20",
      "total_checks": 17,
      "passed": 15,
      "failed": 2,
      "skipped": 0
    },
    "windows-10-pro": {
      "host": "192.168.100.30",
      "total_checks": 9,
      "passed": 9,
      "failed": 0,
      "skipped": 0
    }
  },
  "summary": {
    "total_checks": 51,
    "total_passed": 47,
    "total_failed": 4,
    "total_skipped": 0,
    "score_percentage": 92.16
  }
}
```

---

## Примечания

1. **Цвета в терминале:** Скрипт использует ANSI цвета для лучшей читаемости
2. **Коды выхода:** 
   - `0` - все проверки пройдены
   - `1` - обнаружены неисправленные уязвимости
3. **Формат вывода:** Можно перенаправить в файл для дальнейшего анализа
4. **Интеграция:** Скрипты можно интегрировать в системы автоматической оценки

