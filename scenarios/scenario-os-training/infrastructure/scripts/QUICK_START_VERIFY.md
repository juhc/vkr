# Быстрый старт: Проверка исправлений уязвимостей

## ✅ Да, есть скрипты для проверки исправлений!

## Способ 1: Bash скрипт (рекомендуется для быстрой проверки)

### Использование

```bash
cd infrastructure/scripts
chmod +x verify-fixes.sh
./verify-fixes.sh
```

### Что проверяет

**Ubuntu Server:**
- ✅ Root login отключен
- ✅ Парольная аутентификация отключена
- ✅ PAM ограничения включены
- ✅ Fail2ban запущен
- ✅ UFW включен
- ✅ Небезопасные порты закрыты
- ✅ Автоматические обновления включены
- ✅ Правильные права доступа (755 для /etc, /var, 640 для /etc/shadow)
- ✅ AppArmor включен
- ✅ Лишние службы отключены
- ✅ Directory listing отключен
- ✅ rsyslog включен
- ✅ Пользователи не в группе docker
- ✅ ASLR включен

**Windows машины:**
- ✅ Доступность через ping
- ✅ Открытые порты (RDP, WinRM)

### Пример вывода

```
==========================================
Проверка исправлений уязвимостей
==========================================

=== Ubuntu Server (192.168.100.10) ===

✓ Ubuntu Server доступен
✓ Root login отключен
✓ Парольная аутентификация отключена
✓ PAM ограничения включены
✓ Fail2ban установлен и запущен
...

==========================================
Итоговый отчет
==========================================

Всего проверок: 25
Пройдено: 23
Провалено: 2
Пропущено: 0

✗ Обнаружены неисправленные уязвимости.
```

## Способ 2: Ansible playbook (детальная проверка)

### Использование

```bash
cd infrastructure/ansible
ansible-playbook -i inventory.yml verify-fixes.yml
```

### Что проверяет

**Ubuntu Server:** Все проверки из bash скрипта + дополнительные

**Windows Server 2016:**
- ✅ Политика паролей (минимальная длина >= 12)
- ✅ Политика сложности паролей
- ✅ PowerShell Remoting ограничен
- ✅ SMBv1 отключен
- ✅ NTLMv1 отключен
- ✅ Брандмауэр включен
- ✅ Автоматические обновления включены

**Windows 10 Pro:**
- ✅ UAC включен
- ✅ Windows Defender включен
- ✅ SMBv1 отключен

### Пример использования

```bash
# Только Ubuntu Server
ansible-playbook -i inventory.yml verify-fixes.yml --limit ubuntu-server

# Только Windows машины
ansible-playbook -i inventory.yml verify-fixes.yml --limit windows

# Все машины
ansible-playbook -i inventory.yml verify-fixes.yml
```

## Настройка

### Ubuntu Server

Скрипт использует SSH ключ `~/.ssh/id_rsa` по умолчанию. Если используется другой ключ, отредактируйте переменную в скрипте:

```bash
UBUNTU_SSH_KEY="${HOME}/.ssh/id_ed25519"
```

### Windows машины

Для детальной проверки Windows требуется настроенный WinRM (см. `DEPLOYMENT.md`).

## Рекомендации

1. **Для студентов:** Используйте bash скрипт для самопроверки
2. **Для преподавателей:** Используйте Ansible playbook для детальной проверки
3. **Для автоматизации:** Интегрируйте в систему оценки

## Документация

- Полное руководство: `README_VERIFY.md`
- Описание уязвимостей: `../../docs/overview/machine-scenarios.md`
- Чек-лист: `../../docs/assessment/CHECKLIST.md`

